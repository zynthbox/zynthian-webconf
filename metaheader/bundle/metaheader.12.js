(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{423:function(e,t,n){"use strict";n.r(t);var a=n(34),r=n.n(a),i=n(2),l=n.n(i),o=n(35),c=n.n(o),s=n(0),u=n.n(s),p=n(94),f=n(6),d=n.n(f),h=n(1),m=n.n(h),E=n(58),w=n.n(E),b=n(139),v=n(372),y=n(135),g=n(371),F=n(70),O=n(39);var j=function(e){var t=e.file,n=e.index,a=e.uploadProgress,r=a;return a>0&&(r=parseInt(100*a/t.size)),u.a.createElement("div",{className:"file-uploader-list-item"},u.a.createElement("div",{className:"list-item-file-info"},u.a.createElement("span",{className:"file-name"},t.path),u.a.createElement("span",{className:"file-size"},Object(O.a)(t.size))),u.a.createElement("div",{className:"list-item-progress-container"},u.a.createElement("div",{className:"list-item-progress-bar",style:{width:r+"%"}},u.a.createElement("span",null,Object(O.a)(a)))),u.a.createElement("div",{className:"list-item-actions"},u.a.createElement("a",{className:"button",onClick:function(){return e.renameFile(n)}},u.a.createElement(y.a,null)),u.a.createElement("a",{className:"button",onClick:function(){return e.uploadFile(n)}},u.a.createElement(g.a,null)),u.a.createElement("a",{className:"button",onClick:function(){return e.removeFile(n)}},u.a.createElement(v.a,null))))},S=function(e){var t=e.selectedFolder,n=e.fsep,a=Object(s.useCallback)((function(e){var t=[];for(var n in e)t[n]=null!==C?C[n]:0;D(t),y(e)}),[]),i=Object(b.b)({onDrop:a}),o=i.getRootProps,p=i.getInputProps,f=i.isDragActive,h=Object(s.useState)(null),E=l()(h,2),v=E[0],y=E[1],g=Object(s.useState)(""),O=l()(g,2),S=O[0],x=O[1],N=Object(s.useState)(null),k=l()(N,2),C=k[0],D=k[1],T=Object(s.useState)(!1),P=l()(T,2),R=P[0],M=P[1],U=Object(s.useState)(null),I=l()(U,2),L=I[0],_=I[1];Object(s.useEffect)((function(){null!==v&&(document.getElementById("file-uploader").offsetHeight<37*(v.length+1)?x(" w-scroll"):x(""))}),[v]),Object(s.useEffect)((function(){!0===R&&_(0)}),[R]),Object(s.useEffect)((function(){null!==L&&V(L,!0)}),[L]);var A,H,z=function(e){},J=function(e){var t=[].concat(m()(v.slice(0,e)),m()(v.slice(e+1,v.length)));y(t)},V=function(a){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i="/";null!==t&&(i="/"===t.slice(-1)?t:t+"/");var l=i+v[a].path.split(v[a].name)[0],o="http://".concat(window.location.hostname,":3000/upload/").concat(l.split(n).join("+++")),c=new FormData;c.append("file",v[a]);var s={onUploadProgress:function(e){var t=[].concat(m()(C.slice(0,a)),[e.loaded],m()(C.slice(a+1,C.length)));D(t)}};w.a.post(o,c,s).then((function(t){!0===r&&(a+1<v.length?_(a+1):(e.setShowFileUploader(!1),e.refreshFileManager(t.data)))}))},B=function(){var e=r()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:M(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(v&&v.length>0){var G=v.map((function(e,t){return u.a.createElement(j,{key:t,index:t,file:e,uploadProgress:C[t],renameFile:z,removeFile:J,uploadFile:V})}));A=u.a.createElement("div",{id:"file-uploader-summary-list"},u.a.createElement("div",{id:"file-list",className:S},G),u.a.createElement("div",{id:"file-list-actions"},u.a.createElement("div",{style:{float:"right"}},u.a.createElement("div",{className:"upload-items-counter"},null!==L?L+" / "+v.length+" Total":""),u.a.createElement("a",{className:"button",onClick:function(){return e.setShowFileUploader(!1)}},"Close"),u.a.createElement("a",{className:"button",onClick:B}," Upload Files "))))}else H=u.a.createElement("div",d()({className:"dropzone-container"},o()),u.a.createElement("input",d()({},p(),{name:"file"})),f?u.a.createElement("p",null,"Drop the files here ..."):u.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files"));return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{id:"file-uploader"},u.a.createElement("a",{className:"close-file-uploader",onClick:function(){return e.setShowFileUploader(!1)}},u.a.createElement(F.a,null)),H,A))},x=n(377),N=n(373),k=n.n(N),C=n(4),D=function(e){var t=e.file,n=e.setShowFileViewer,a=(e.selectedFolder,Object(s.useRef)());Object(O.b)(a,(function(){return n(!1)}));var i=t.path.split(".")[t.path.split(".").length-1],o=Object(s.useState)(null),p=l()(o,2),f=p[0],d=p[1],h=Object(s.useState)(!0),m=l()(h,2),E=m[0],b=m[1];function v(){return(v=r()(c.a.mark((function e(){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://".concat(window.location.hostname,":3000/json/").concat(t.path.split("/").join("+++")),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,e.next=5,n.json();case 5:a=e.sent,console.log(a," GET JSON RES"),d(a),b(!1);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=r()(c.a.mark((function e(n){var a,r,i,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new File([n],t.name,{type:"application/json"}),(r=new FormData).append("file",a,t.name),i=t.path.split("/home/pi")[1].split(t.name)[0],l="http://".concat(window.location.hostname,":3000/upload/").concat(i.split("/").join("+++")),w.a.post(l,r).then((function(e){console.log(e," RES ")}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(s.useEffect)((function(){"json"===i&&function(){v.apply(this,arguments)}()}),[]);var g=u.a.createElement(C.a,null);return"json"===i&&!1===E&&(g=u.a.createElement("div",{className:"json-viewer-container"},u.a.createElement(x.a,{id:t.path,placeholder:f,locale:k.a,height:"100%",width:"100%",onChange:function(e){!function(e){y.apply(this,arguments)}(e.json)}}))),u.a.createElement("div",{ref:a,id:"file-viewer"},u.a.createElement("a",{className:"close-file-viewer",onClick:function(){return n(!1)}},u.a.createElement(F.a,null)),g)},T=n(375),P=n(374),R=n(69),M=n(7);var U=function(e){var t=Object(s.useContext)(M.a),n=t.fileManagerState,a=t.fileManagerDispatch,r=n.browseHistory,i=n.browseHistoryIndex,o=e.getFiles,c=Object(s.useState)(!1),f=l()(c,2),d=f[0],h=f[1];Object(s.useEffect)((function(){setTimeout((function(){var e=document.getElementsByClassName("fa-level-up-alt")[0];e&&null!==e&&e.setAttribute("transform","scale(-1 1)");document.evaluate("//span[text()='Actions']",document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue.innerText="More..."}),10)}),[]);var m,E=Object(s.useRef)();function w(e){var t;"number"==typeof(t="back"===e&&n.browseHistoryIndex-1>=0?n.browseHistoryIndex-1:"forward"===e&&n.browseHistoryIndex+1<=n.browseHistory.length-1?n.browseHistoryIndex+1:e)&&a({type:"SET_SELECTED_FOLDER",payload:n.browseHistory[t],isViewingHistory:!0,browseHistoryIndex:t})}if(Object(O.b)(E,(function(){return h(!1)})),!0===d){var b=r.map((function(e,t){var n,a="/home/pi/"===e.path?"zynthian":e.path.indexOf("/home/pi/")>-1?"zynthian/"+e.path.split("/home/pi/")[1]:e.path;return t===i&&(n="active"),u.a.createElement("li",null,u.a.createElement("a",{className:n,title:e.path,onClick:function(){return w(t)}},a))}));m=u.a.createElement("div",{ref:E,className:"browser-history-submenu"},u.a.createElement("a",{onClick:function(){return h(!1)},className:"close-browser-history"},u.a.createElement(R.e,null)),u.a.createElement("ul",null,b))}return u.a.createElement("div",{className:"file-navbar-container-custom"},u.a.createElement("ul",{className:"browser-navigation-menu"},u.a.createElement("li",null,u.a.createElement("a",{onClick:function(){return h(!0)}},u.a.createElement(P.a,null))),u.a.createElement("li",null,u.a.createElement("a",{onClick:function(){return w("back")}},u.a.createElement(T.a,null))),u.a.createElement("li",null,u.a.createElement("a",{onClick:function(){return w("forward")}},u.a.createElement(T.b,null)))),m,u.a.createElement(p.f,null),u.a.createElement("a",{className:"refresh-button",onClick:function(){return o()}},u.a.createElement("span",null,"Refresh"),u.a.createElement(T.c,null)))};t.default=function(e){var t=Object(s.useContext)(M.a),n=t.fileManagerState,a=t.fileManagerDispatch,i=n.displayedFiles,o=n.selectedFolder,f=n.folderChain,d=(n.ffolder,e.fsep),h=Object(s.useState)(""),m=l()(h,2),E=m[0],w=m[1],b=Object(s.useState)(""),v=l()(b,2),y=v[0],g=v[1],F=Object(s.useState)(!1),O=l()(F,2),j=O[0],x=O[1],N=Object(s.useState)(!1),k=l()(N,2),T=k[0],P=k[1],R=Object(s.useState)(""),I=l()(R,2),L=I[0],_=I[1],A=Object(s.useState)(""),H=l()(A,2),z=H[0],J=H[1],V=Object(s.useState)(""),B=l()(V,2),G=B[0],Y=B[1],q=Object(s.useRef)(null);function X(){q.current&&q.current.requestFileAction(p.a.ClearSelection)}function K(){var e=window.prompt("Enter new Folder Name:");null!==e&&function(e){Q.apply(this,arguments)}((null!==o?o+d:"")+e)}function Q(){return(Q=r()(c.a.mark((function t(n){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://".concat(window.location.hostname,":3000/createfolder"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullPath:n})});case 2:return a=t.sent,t.next=5,a.json();case 5:t.sent,e.getFiles();case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function W(e){var t=e.state.selectedFiles[0].path,n=t.split("/")[t.split("/").length-1],r=window.prompt('Enter new name for "'.concat(n,'":'),n);if(null!==r){var i=null===o?"/home/pi/"+r:t.split(o)[0]+o+"/"+r;a({type:"RENAME_FILE",payload:{previousPath:t,fullPath:i}}),function(e,t){Z.apply(this,arguments)}(t,i)}}function Z(){return(Z=r()(c.a.mark((function t(n,a){var r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://".concat(window.location.hostname,":3000/rename"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullPath:a,previousPath:n})});case 2:return r=t.sent,t.next=5,r.json();case 5:i=t.sent,e.getFiles(i);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $(e,t){return ee.apply(this,arguments)}function ee(){return(ee=r()(c.a.mark((function t(n,a){var i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=n[a],fetch("http://".concat(window.location.hostname,":3000/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullPath:i})}).then(function(){var t=r()(c.a.mark((function t(r){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a!==n.length-1){t.next=10;break}return t.next=3,r.json();case 3:t.sent,X(),P(!1),_(""),e.getFiles(),t.next=11;break;case 10:$(n,a+1);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function te(){return(te=r()(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],t.state.selectedFiles.forEach((function(e,t){n.push(e.path)})),n.length>0&&(_("Preparing Download"),P(!0),n.forEach(function(){var e=r()(c.a.mark((function e(t,n){var a,r,i,l,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://".concat(window.location.hostname,":3000/download"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:t})});case 2:return a=e.sent,e.next=5,a.blob();case 5:r=e.sent,i=window.URL.createObjectURL(r),(l=document.createElement("a")).href=i,-1===(o=t.split(d)[t.split(d).length-1]).indexOf(".zip")&&"application/zip"===r.type&&(o+=".zip"),l.download=o,document.body.appendChild(l),l.click(),l.remove(),P(!1),_("");case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e,t,n){return ae.apply(this,arguments)}function ae(){return(ae=r()(c.a.mark((function e(t,n,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_("Copying Files"),P(!0),console.log(t,n),re(t,n,a,0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e,t,n,a){return ie.apply(this,arguments)}function ie(){return(ie=r()(c.a.mark((function t(n,i,l,o){var s,u;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("COPY PASTE FILES"),s=n[o],u=i[o],fetch("http://".concat(window.location.hostname,":3000/copypaste"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({previousPath:s,destinationPath:"/"+u,deleteOrigin:l})}).then(function(){var t=r()(c.a.mark((function t(r){var s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o!==n.length-1){t.next=11;break}return!0===l&&a({type:"DELETE_FILES",payload:n}),t.next=4,r.json();case 4:s=t.sent,X(),P(!1),_(""),e.refreshFileManager(s),t.next=12;break;case 11:re(n,i,l,o+1);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var le,oe,ce,se,ue=Object(p.h)({id:"create_files",button:{name:"Add Folder",toolbar:!0,contextMenu:!0,icon:p.b.folderCreate}}),pe=Object(p.h)({id:"edit_files",button:{name:"Edit",contextMenu:!0,icon:p.b.archive}}),fe=Object(p.h)({id:"rename_files",button:{name:"Rename",contextMenu:!0,icon:p.b.code}}),de=Object(p.h)({id:"paste_files",button:{name:"Paste",contextMenu:!0,icon:p.b.paste}}),he=Object(p.h)({id:p.a.UploadFiles.id,button:{name:"Upload",toolbar:!0,contextMenu:!0,icon:p.b.upload}}),me=Object(p.h)({id:p.a.DownloadFiles.id,button:{name:"Download",toolbar:!0,contextMenu:!0,icon:p.b.download}}),Ee=[ue,pe,fe,he,me,p.a.DeleteFiles,p.a.CopyFiles,p.a.StartDragNDrop,p.a.EndDragNDrop,de];return!0===e.showFileUploader&&(oe=u.a.createElement(u.a.Fragment,null,u.a.createElement(S,{selectedFolder:o,fsep:d,refreshFileManager:e.refreshFileManager,setShowFileUploader:e.setShowFileUploader}))),!0===T&&(ce=u.a.createElement("div",{className:"file-browser-loading-spinner-container"},u.a.createElement(C.a,{text:L}))),!0===z&&(se=u.a.createElement(D,{file:G,setShowFileViewer:J,selectedFolder:o})),u.a.createElement("div",{style:{height:window.innerHeight-170,position:"relative"},onDragOver:function(){!1===j&&(clearTimeout(le),e.setShowFileUploader(!0))},onDragLeave:function(){le=setTimeout((function(){e.setShowFileUploader(!1)}),10)}},ce,oe,se,u.a.createElement(p.c,{files:i,folderChain:f,fileActions:Ee,onFileAction:function(t){var n;t.id===p.a.OpenFiles.id&&function(e){var t=e.payload.files[0];!0===t.isDir?a({type:"SET_SELECTED_FOLDER",payload:t}):t.path.indexOf(".")>-1&&"json"===t.path.split(".")[t.path.split(".").length-1]&&(Y(t),J(!0))}(t),t.id===ue.id&&K(),t.id===pe.id&&alert("Edit Folder Action"),t.id===fe.id&&W(t),t.id===p.a.UploadFiles.id&&e.setShowFileUploader(!0),t.id===p.a.DownloadFiles.id&&function(e){te.apply(this,arguments)}(t),t.id===p.a.DeleteFiles.id&&function(e){var t="are you sure you want to delete following files? \n",n=[];e.state.selectedFilesForAction.forEach((function(e,a){n.push(e.path),t+=e.path+"\n"})),window.confirm(t)&&(_("Deleting Files"),P(!0),a({type:"DELETE_FILES",payload:n}),$(n,0))}(t),t.id===p.a.CopyFiles.id&&function(e){var t=[];e.state.selectedFiles.forEach((function(e,n){t.push(e.path)})),w(t)}(t),t.id===de.id&&(n=[],E.forEach((function(e,t){var a=o+d;e.indexOf(".")>-1&&(a=(null!==o?o+d:"")+e.split(d)[e.split(d).length-1]),n.push(a)})),ne(E,n)),t.id===p.a.StartDragNDrop.id&&function(e){x(!0);var t=[];e.state.selectedFiles.forEach((function(e,n){t.push(e.path)})),g(t)}(t),t.id===p.a.EndDragNDrop.id&&function(e){x(!1);var t=[];y.forEach((function(t,n){var a="";a=null!==o?o+e.payload.destination.path.split(o)[1]:e.payload.destination.path.split("/home/pi/")[1],t.indexOf(".")>-1&&(a+=d+t.split(d)[t.split(d).length-1]).indexOf("undefined")>-1&&(a=a.split("undefined").join(""))})),y.length>0&&t.length>0&&ne(y,t,!0)}(t)},defaultFileViewActionId:p.a.EnableListView.id,clearSelectionOnOutsideClick:!0,ref:q},u.a.createElement(U,{getFiles:e.getFiles}),u.a.createElement(p.g,null),u.a.createElement(p.e,null),u.a.createElement(p.d,null)))}}}]);