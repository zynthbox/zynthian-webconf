(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{426:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),c=n(17),r=n(20),o=n(22),i=n(10),u=n.n(i),s=n(378),m=n(94),d=n(369),p=n(76),f=n(3),E=n.n(f),h=n(1),v=n.n(h),b=function(e){var t,n,r,o=e.index,i=e.sample,s=e.channelIndex,m=e.sampleSetMode,d=e.onRemoveSample,p=e.onAddSample,f=(e.uploadSample,e.setLoadFromSketchPadSampleIndex,e.setLoadFromSketchPadFileType,e.setShowSampleSetSourcePicker,Object(a.useState)(null)),h=u()(f,2),b=h[0],k=h[1],j=Object(a.useState)(!1),O=u()(j,2),y=O[0],g=O[1];Object(c.d)((function(e){return e.sampleEditor})).sketchpad;function w(){return(w=E()(v.a.mark((function e(){var t,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=i.path.split(".").join("++")).indexOf("/")>-1&&(t=t.split("/").join("+")),e.next=4,fetch("http://".concat(window.location.hostname,":3000/").concat("sample-loop"===m?"clip":"sample","/").concat(s+1+"+++"+t),{method:"GET",headers:{"Content-Type":"application/json"}});case 4:return n=e.sent,e.next=7,n.blob();case 7:S(e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){var t=new FileReader;t.addEventListener("load",(function(){var e=t.result;t.result.indexOf("data:application/octet-stream;")>-1&&(e=t.result.split(":application/octet-stream;").join(":audio/wav;")),k(e)}),!1),t.readAsDataURL(e)}function x(){g(!1),document.getElementById("sample-".concat(s+1,"-").concat(o+1,"-audio-player")).pause()}function N(e){var t=e.target;t.currentTime>=t.duration&&x()}Object(a.useEffect)((function(){i&&i.path&&function(){w.apply(this,arguments)}()}),[i]),i&&null!==i&&null!==i.path?(t=!0===y?l.a.createElement("a",{className:"play-sample-button",onClick:x},l.a.createElement("i",{className:"glyphicon glyphicon-pause"})):l.a.createElement("a",{className:"play-sample-button",onClick:function(){g(!0),document.getElementById("sample-".concat(s+1,"-").concat(o+1,"-audio-player")).play()}},l.a.createElement("i",{className:"glyphicon glyphicon-play-circle"})),n=l.a.createElement("a",{className:"edit-sample-button",onClick:function(){return d(o)}},l.a.createElement("i",{className:"glyphicon glyphicon-trash"}))):n=l.a.createElement("a",{className:"edit-sample-button",onClick:function(){return p(o)}},l.a.createElement("i",{className:"glyphicon glyphicon-plus"})),i&&(r=i.path?i.path:i.name)&&null!==r&&(r.indexOf("/")>-1&&(r=r.split("/")[r.split("/").length-1]),r.split(".")[0].length>16&&(r=r.substring(0,17)+"...wav"));var C,I="---";return r&&null!==r&&(I=r),null!==b&&(C=l.a.createElement("audio",{id:"sample-".concat(s+1,"-").concat(o+1,"-audio-player"),src:b,onTimeUpdate:function(e){return N(e)},onLoadedMetadata:function(e){return N(e)}})),l.a.createElement("li",{id:"sample-".concat(s+1,"-").concat(o+1)},C,t,l.a.createElement("h4",{title:i&&null!==r?i.path:""},I),n)},k=n(88),j=n(162),O=function(e){var t,n=e.index,i=e.samples,u=e.sampleSetMode,s=(e.keyZoneMode,Object(c.c)()),d=Object(c.d)((function(e){return e.sampleEditor})),p=d.sketchpad,f=d.sketchpadInfo,E=d.sourcePicker,h=d.dropZone;function v(e){"Escape"===e.key&&(s(Object(r.i)({showSourcePicker:!1})),s(Object(r.h)({showDropZone:!1})))}function O(){t=setTimeout((function(){s(Object(r.h)({showDropZone:!1}))}),10)}function y(e){s(Object(r.i)({channelIndex:n,sampleIndex:e,showSourcePicker:!0}))}function g(e,t){s(Object(r.n)({files:[e],channelIndex:n,sampleIndex:t}))}function w(e){s(Object(r.f)({channelIndex:n,sampleIndex:e}))}Object(a.useEffect)((function(){return window.addEventListener("keydown",v,!1),function(){window.removeEventListener("keydown",v,!1)}}),[]);var S,x,N=i.map((function(e,t){return l.a.createElement(b,{key:t,index:t,sample:e,channelIndex:n,sampleSetMode:u,onRemoveSample:w,onAddSample:y})}));if(E.channelIndex==n&&!0===E.showSourcePicker){var C=l.a.createElement("a",{className:"button",onClick:function(){s(Object(r.i)({showSourcePicker:!1})),s(Object(r.h)({channelIndex:n,isSampleSet:!0,showDropZone:!0}))}},"Load from External");E.sampleIndex&&(C=l.a.createElement("a",{className:"button"},l.a.createElement("input",{type:"file",onChange:function(e){return g(e.target.files[0],E.sampleIndex)}}),"Load from External")),S=l.a.createElement("div",{className:"sample-set-upload-container source-picker"},l.a.createElement("a",{className:"close-source-picker",onClick:function(){return s(Object(r.i)({showSourcePicker:!1}))}},l.a.createElement(k.f,null)),l.a.createElement("a",{className:"button",onClick:function(){return e=E.sampleIndex,s(Object(o.d)({folder:f.lastSelectedSketchpad.split("".concat(p.name,".sketchpad.json"))[0],mode:"LOAD",type:e||0===e?".wav":"sample-bank.json",sampleIndex:e,channelIndex:n})),void s(Object(r.i)({showSourcePicker:!1}));var e}},"Pick from Internal"),C)}h.channelIndex==n&&!0===h.isSampleSet&&!0===h.showDropZone&&(x=l.a.createElement("div",{className:"sample-set-upload-container"},l.a.createElement("div",{className:"dropzone-container"},l.a.createElement(j.a,{onDrop:function(e){return t=e,void s(Object(r.n)({files:t,channelIndex:n}));var t}},(function(e){var t=e.getRootProps,n=e.getInputProps;return l.a.createElement("section",null,l.a.createElement("div",t(),l.a.createElement("input",n()),l.a.createElement("p",null,"Drag 'n' drop some files here")))})))));var I="hidden";!0===h.showDropZone&&h.channelIndex==n&&0==h.isSampleSet&&(I="");var M=p.channels[n].samples.indexOf(null);return-1==M&&(M=p.channels[n].samples.length-1),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"sample-list-container "+("sample-loop"===u?"show-clips":""),onDragOver:function(){clearTimeout(t),s(Object(r.h)({showDropZone:!0,channelIndex:n,isSampleSet:!1}))},onDragLeave:O},l.a.createElement("div",{className:"dropzone-container "+I},l.a.createElement(j.a,{onDrop:function(e){return g(e[0],M)}},(function(e){var t=e.getRootProps,n=e.getInputProps;return l.a.createElement("section",null,l.a.createElement("div",t(),l.a.createElement("a",{onClick:function(){return O()},className:"close-source-picker"},l.a.createElement(k.f,null)),l.a.createElement("input",n()),l.a.createElement("p",null,"Drag 'n' drop some files here")))}))),l.a.createElement("ul",{className:"sample-list"},N)),l.a.createElement("ul",{className:"sample-set-actions"},l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){s(Object(r.f)({channelIndex:n}))}},l.a.createElement("i",{style:{marginTop:"1px"},className:"glyphicon glyphicon-trash"}))),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){}}," ",l.a.createElement(m.c,null)," ")),l.a.createElement("li",{style:{float:"right"}},l.a.createElement("a",{onClick:function(){s(Object(r.i)({channelIndex:n,showSourcePicker:!0}))}},l.a.createElement("i",{className:"glyphicon glyphicon-plus"})))),S,x)},y=function(e){var t=e.index,n=e.keyZoneMode,a=e.channelAudioType,o=Object(c.c)();function i(e){o(Object(r.k)({index:t,keyZoneMode:n,channelAudioType:e}))}function u(e){o(Object(r.k)({index:t,keyzone_mode:e,channelAudioType:a}))}return l.a.createElement("div",{className:"track-keyzone-mode-menu"},l.a.createElement("div",{className:"track-audio-type-menu-container"},l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return i("sample-trig")},className:"sample-trig"===a?"is-active":""},"Trig")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return i("sample-slice")},className:"sample-slice"===a?"is-active":""},"Slice")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return i("synth")},className:"synth"===a?"is-active":""},"Synth")))),l.a.createElement("div",{style:{opacity:"sample-trig"==a?"1":"0"},className:"keyzone-mode-menu-container"},l.a.createElement("span",null,"Auto Split:"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return u("all-full")},className:"all-full"===n?"is-active":""},"Off")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return u("split-full")},className:"split-full"===n?"is-active":""},"Auto")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return u("split-narrow")},className:"split-narrow"===n?"is-active":""},"Narrow")))))},g=n(157),w=function(e){var t=e.showEditMode,n=e.setShowEditMode,o=e.title,i=e.index,s=Object(c.c)(),m=Object(a.useState)(o),d=u()(m,2),f=d[0],E=d[1],h=Object(a.useRef)(null),v=Object(a.useRef)(null);function b(e){"Escape"===e.key?h.current.click():"Enter"===e.key&&v.current.click()}Object(a.useEffect)((function(){return window.removeEventListener("keydown",b,!1),window.addEventListener("keydown",b,!1),function(){window.removeEventListener("keydown",b,!1)}}),[o]),Object(a.useEffect)((function(){!0===t&&E(o)}),[t]);var k=Object(a.useRef)();Object(p.d)(k,(function(e){"edit-button"!==e.target.className&&n(!1)}));var j,O=null===o?"Track ".concat(i+1):o;return j=!0===t?l.a.createElement("div",{className:"input-wrapper"},l.a.createElement("input",{type:"text",placeholder:"",value:o,onChange:function(e){return s(Object(r.l)({index:i,title:e.target.value}))},autoFocus:!0}),l.a.createElement("a",{ref:h,className:"undo-title-change",onClick:function(){s(Object(r.l)({index:i,title:f})),n(!1)}},l.a.createElement(g.b,null)),l.a.createElement("a",{ref:v,className:"save-changes",onClick:function(){return E(o),void n(!1)}})):l.a.createElement("h2",null,O),l.a.createElement("div",{className:"sample-set-title"},l.a.createElement("div",{ref:k,className:"title-wrapper"},j))},S=function(e){var t,n=Object(c.c)(),o=e.index,i=e.channel,f=e.color,E=Object(a.useState)(!1),h=u()(E,2),v=h[0],b=h[1],k=Object(a.useState)(!1),j=u()(k,2),g=j[0],S=j[1],x=Object(a.useRef)();return Object(p.d)(x,(function(){return S(!1)})),!0===g&&(t=l.a.createElement("div",{className:"color-picker-container"},l.a.createElement(s.a,{color:f,onChange:function(e){return n(Object(r.j)({index:o,color:e.hex}))}}))),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"sample-set",style:{backgroundColor:e.color}},l.a.createElement("div",{ref:x,className:"edit-menu-container"},l.a.createElement("ul",{className:"edit-menu"},l.a.createElement("li",null,l.a.createElement("a",{className:"edit-button",onClick:function(){return b(1!=v)}},l.a.createElement(d.a,null),l.a.createElement("span",{className:"edit-button"}))),l.a.createElement("li",null,l.a.createElement("a",{className:"color-picker",onClick:function(){return S(1!=g)}},l.a.createElement(m.d,null)))),t),l.a.createElement(w,{showEditMode:v,title:i.name,index:o,setShowEditMode:b}),l.a.createElement(y,{index:o,keyZoneMode:i.keyzone_mode,channelAudioType:i.channelAudioType}),l.a.createElement(O,{index:o,samples:"sample-loop"===i.channelAudioType?i.clips:i.samples,sampleSetMode:i.channelAudioType,keyZoneMode:i.keyzone_mode})))},x=n(370),N=n(158),C=function(e){var t=Object(c.c)(),n=Object(c.d)((function(e){return e.filePicker})),r=n.folder,i=n.initFolder,s=n.mode,d=n.files,f=n.selectedFile,E=n.type,h=n.channelIndex,v=n.sampleIndex,b=Object(a.useState)(""),j=u()(b,2),O=j[0],y=j[1];Object(a.useEffect)((function(){null!==r&&t(Object(o.b)())}),[r]);var g=Object(a.useRef)();function w(n){t(Object(o.c)()),e.onSelectFile(n,h,v)}Object(p.d)(g,(function(e){t(Object(o.c)())}));var S,C="sample-set-load-from-sketch-pad-dialog";"SAVE"===s&&(C+=" w-save",S=l.a.createElement("div",{className:"dialog-footer"},l.a.createElement("input",{value:O,onChange:function(e){return y(e.target.value)},type:"text"}),l.a.createElement("button",{onClick:function(){w(r+O+E)}},"Save")));var I,M=l.a.createElement("li",null,l.a.createElement("a",null,"No files of type ".concat(E," were found")));return null!==d&&d.length>0&&(M=d.map((function(e,n){var a=l.a.createElement(m.a,null),c="folder";return!1===e.isDir&&(a="wav"===(c=e.name.split(".")[e.name.split(".").length-1])?l.a.createElement(N.b,null):"json"===c?l.a.createElement(x.a,null):l.a.createElement(N.a,null)),l.a.createElement("li",{key:n},l.a.createElement("a",{onClick:function(){return t(Object(o.f)(e.name))},className:e.name===f?"active":"",onDoubleClick:function(){return function(e,n){"folder"===n||"cache"===n?t(Object(o.e)(e.path+"/")):w(e)}(e,c)}},a," ",e.name))}))),r!==i&&(I=l.a.createElement("li",null,l.a.createElement("a",{onDoubleClick:function(){return e=r.split("/")[r.split("/").length-2]+"/",n=r.split(e)[0],void t(Object(o.e)(n));var e,n}},l.a.createElement(m.b,null),"..."))),l.a.createElement("div",{ref:g,className:C},l.a.createElement("a",{className:"close",onClick:function(){return t(Object(o.c)())}},l.a.createElement(k.f,null)),l.a.createElement("h4",null,s," FROM SKETCH PAD"),l.a.createElement("ul",null,I,M),S)};t.default=function(e){var t,n=e.colorsArray,i=Object(c.d)((function(e){return e.sampleEditor})),u=i.sketchpadInfo,s=i.sketchpad,m=i.pendingFiles,d=Object(c.d)((function(e){return e.filePicker})),p=d.showFilePicker,f=d.mode,E=d.type,h=Object(c.c)();if(Object(a.useEffect)((function(){h(Object(r.e)())}),[]),Object(a.useEffect)((function(){null!==u&&h(Object(r.d)())}),[u]),Object(a.useEffect)((function(){if(null!==m.files){var e=m.files,t=m.channelIndex;h(Object(r.b)({files:e,channelIndex:t}))}}),[m]),null!==s){var v=u.lastSelectedSketchpad,b=v.split("/")[v.split("/").length-1],k=v.split(b)[0];k.indexOf("/zynthian/")>-1&&(k="/"+k.split("/zynthian/")[1]),t=s.channels.map((function(e,t){return l.a.createElement(S,{key:t,index:t,color:e.color&&"#000000"!==e.color?e.color:n[t],channel:e})}))}var j,O={height:window.innerHeight-165};return window.innerHeight<865&&(O["overflow-y"]="scroll"),!0===p&&(j=l.a.createElement(C,{onSelectFile:function(e,t,n){if(".sketchpad.json"===E)if("SAVE"===f){var a=e,l=a.split("/")[a.split("/").length-1].split(".sketchpad.json")[0];h(Object(r.g)("/"+a.split("/zynthian/")[1])),h(Object(r.m)({filePath:a,fileName:l}))}else{var c=e;h(Object(r.m)({filePath:c.path,fileName:c.name}))}else".wav"===E?"LOAD"===f&&h(Object(r.b)({files:[e],channelIndex:t,sampleIndex:n})):"sample-bank.json"===E&&"LOAD"===f&&h(Object(r.a)({sampleSet:e,channelIndex:t}))}})),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"sample-editor-menu"},l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("a",null,"New")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return e=u.lastSelectedSketchpad.split(s.name)[0],void h(Object(o.d)({folder:e,mode:"LOAD",type:".sketchpad.json"}));var e}},"Load")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return h(Object(r.g)())}},"Save")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){var e;e=u.lastSelectedSketchpad.split("".concat(s.name,".sketchpad.json"))[0],h(Object(o.d)({folder:e,mode:"SAVE",type:".sketchpad.json"}))}},"Save As...")),null!==u?l.a.createElement("li",{style:{float:"right"}},l.a.createElement("a",null,u.lastSelectedSketchpad)):"")),l.a.createElement("div",{id:"sample-editor",style:O},t),j)}},76:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return m}));var a=n(10),l=n.n(a),c=(n(83),n(0));function r(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=t?1e3:1024;if(Math.abs(e)<a)return e+" B";var l=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],c=-1,r=Math.pow(10,n);do{e/=a,++c}while(Math.round(Math.abs(e)*r)/r>=a&&c<l.length-1);return e.toFixed(n)+" "+l[c]}function o(e,t){Object(c.useEffect)((function(){var n=function(n){e.current&&!e.current.contains(n.target)&&t(n)};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),function(){document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,t])}function i(e){var t=Object(c.useRef)();return Object(c.useEffect)((function(){t.current=e}),[e]),t.current}var u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.shouldPreventDefault,r=void 0===a||a,o=n.delay,i=void 0===o?300:o,u=Object(c.useState)(!1),m=l()(u,2),d=m[0],p=m[1],f=Object(c.useRef)(),E=Object(c.useRef)(),h=Object(c.useCallback)((function(t){r&&t.target&&(t.target.addEventListener("touchend",s,{passive:!1}),E.current=t.target),f.current=setTimeout((function(){e(t),p(!0)}),i)}),[e,i,r]),v=Object(c.useCallback)((function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];f.current&&clearTimeout(f.current),n&&!d&&t(),p(!1),r&&E.current&&E.current.removeEventListener("touchend",s)}),[r,t,d]);return{onMouseDown:function(e){return h(e)},onTouchStart:function(e){return h(e)},onMouseUp:function(e){return v(e)},onMouseLeave:function(e){return v(e,!1)},onTouchEnd:function(e){return v(e)}}},s=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()};function m(e){var t=Math.floor(e/60),n=e-60*t;return t<10&&(t="0"+t),(n=Math.floor(n))<10&&(n="0"+n),t+":"+n}}}]);