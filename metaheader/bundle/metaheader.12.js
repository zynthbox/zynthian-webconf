(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{426:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),c=n(18),r=n(20),o=n(25),i=n(10),u=n.n(i),s=n(378),m=n(94),d=n(369),p=n(76),f=n(3),E=n.n(f),h=n(1),v=n.n(h),b=function(e){var t,n,r,o=e.index,i=e.sample,s=e.channelIndex,m=e.sampleSetMode,d=e.onRemoveSample,p=e.onAddSample,f=(e.uploadSample,e.setLoadFromSketchPadSampleIndex,e.setLoadFromSketchPadFileType,e.setShowSampleSetSourcePicker,Object(a.useState)(null)),h=u()(f,2),b=h[0],k=h[1],O=Object(a.useState)(!1),j=u()(O,2),y=j[0],g=j[1];Object(c.d)((function(e){return e.sampleEditor})).sketchpad;function w(){return(w=E()(v.a.mark((function e(){var t,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=i.path.split(".").join("++")).indexOf("/")>-1&&(t=t.split("/").join("+")),e.next=4,fetch("http://".concat(window.location.hostname,":3000/").concat("sample-loop"===m?"clip":"sample","/").concat(s+1+"+++"+t),{method:"GET",headers:{"Content-Type":"application/json"}});case 4:return n=e.sent,e.next=7,n.blob();case 7:S(e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){var t=new FileReader;t.addEventListener("load",(function(){var e=t.result;t.result.indexOf("data:application/octet-stream;")>-1&&(e=t.result.split(":application/octet-stream;").join(":audio/wav;")),k(e)}),!1),t.readAsDataURL(e)}function N(){g(!1),document.getElementById("sample-".concat(s+1,"-").concat(o+1,"-audio-player")).pause()}function x(e){var t=e.target;t.currentTime>=t.duration&&N()}Object(a.useEffect)((function(){i&&i.path&&function(){w.apply(this,arguments)}()}),[i]),i&&null!==i&&null!==i.path?(t=!0===y?l.a.createElement("a",{className:"play-sample-button",onClick:N},l.a.createElement("i",{className:"glyphicon glyphicon-pause"})):l.a.createElement("a",{className:"play-sample-button",onClick:function(){g(!0),document.getElementById("sample-".concat(s+1,"-").concat(o+1,"-audio-player")).play()}},l.a.createElement("i",{className:"glyphicon glyphicon-play-circle"})),n=l.a.createElement("a",{className:"edit-sample-button",onClick:function(){return d(o)}},l.a.createElement("i",{className:"glyphicon glyphicon-trash"}))):n=l.a.createElement("a",{className:"edit-sample-button",onClick:function(){return p(o)}},l.a.createElement("i",{className:"glyphicon glyphicon-plus"})),i&&(r=i.path?i.path:i.name)&&null!==r&&(r.indexOf("/")>-1&&(r=r.split("/")[r.split("/").length-1]),r.split(".")[0].length>16&&(r=r.substring(0,17)+"...wav"));var C,I="---";return r&&null!==r&&(I=r),null!==b&&(C=l.a.createElement("audio",{id:"sample-".concat(s+1,"-").concat(o+1,"-audio-player"),src:b,onTimeUpdate:function(e){return x(e)},onLoadedMetadata:function(e){return x(e)}})),l.a.createElement("li",{id:"sample-".concat(s+1,"-").concat(o+1)},C,t,l.a.createElement("h4",{title:i&&null!==r?i.path:""},I),n)},k=n(88),O=n(162),j=function(e){var t,n=e.index,o=e.samples,i=e.sampleSetMode,u=(e.keyZoneMode,Object(c.c)()),s=Object(c.d)((function(e){return e.sampleEditor})),d=s.sketchpad,p=s.sourcePicker,f=s.dropZone;function E(e){"Escape"===e.key&&(u(Object(r.g)({showSourcePicker:!1})),u(Object(r.f)({showDropZone:!1})))}function h(){t=setTimeout((function(){u(Object(r.f)({showDropZone:!1}))}),10)}function v(e){u(Object(r.g)({channelIndex:n,sampleIndex:e,showSourcePicker:!0}))}function j(e,t){u(Object(r.l)({files:[e],channelIndex:n,sampleIndex:t}))}function y(e){u(Object(r.d)({channelIndex:n,sampleIndex:e}))}Object(a.useEffect)((function(){return window.addEventListener("keydown",E,!1),function(){window.removeEventListener("keydown",E,!1)}}),[]);var g,w,S=o.map((function(e,t){return l.a.createElement(b,{key:t,index:t,sample:e,channelIndex:n,sampleSetMode:i,onRemoveSample:y,onAddSample:v})}));if(p.channelIndex==n&&!0===p.showSourcePicker){var N=l.a.createElement("a",{className:"button",onClick:function(){u(Object(r.f)({channelIndex:n,isSampleSet:!0,showDropZone:!0}))}},"Load from External");null!==p.sampleIndex&&(N=l.a.createElement("a",{className:"button"},l.a.createElement("input",{type:"file",onChange:function(e){return j(e.target.files[0],p.sampleIndex)}}),"Load from External")),g=l.a.createElement("div",{className:"sample-set-upload-container source-picker"},l.a.createElement("a",{className:"close-source-picker",onClick:function(){return u(Object(r.g)({showSourcePicker:!1}))}},l.a.createElement(k.f,null)),l.a.createElement("a",{className:"button",onClick:function(){console.log("pick from internal BIATCH!!!!")}},"Pick from Internal"),N)}f.channelIndex==n&&!0===f.isSampleSet&&!0===f.showDropZone&&(w=l.a.createElement("div",{className:"sample-set-upload-container"},l.a.createElement("div",{className:"dropzone-container"},l.a.createElement(O.a,{onDrop:function(e){return t=e,void u(Object(r.l)({files:t,channelIndex:n}));var t}},(function(e){var t=e.getRootProps,n=e.getInputProps;return l.a.createElement("section",null,l.a.createElement("div",t(),l.a.createElement("input",n()),l.a.createElement("p",null,"Drag 'n' drop some files here")))})))));var x="hidden";!0===f.showDropZone&&f.channelIndex==n&&0==f.isSampleSet&&(x="");var C=d.channels[n].samples.indexOf(null);return-1==C&&(C=d.channels[n].samples.length-1),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"sample-list-container "+("sample-loop"===i?"show-clips":""),onDragOver:function(){clearTimeout(t),u(Object(r.f)({showDropZone:!0,channelIndex:n,isSampleSet:!1}))},onDragLeave:h},l.a.createElement("div",{className:"dropzone-container "+x},l.a.createElement(O.a,{onDrop:function(e){return j(e[0],C)}},(function(e){var t=e.getRootProps,n=e.getInputProps;return l.a.createElement("section",null,l.a.createElement("div",t(),l.a.createElement("a",{onClick:function(){return h()},className:"close-source-picker"},l.a.createElement(k.f,null)),l.a.createElement("input",n()),l.a.createElement("p",null,"Drag 'n' drop some files here")))}))),l.a.createElement("ul",{className:"sample-list"},S)),l.a.createElement("ul",{className:"sample-set-actions"},l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){u(Object(r.d)({channelIndex:n}))}},l.a.createElement("i",{style:{marginTop:"1px"},className:"glyphicon glyphicon-trash"}))),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){console.log("SAVE SAMPLE SET AS SUKKKAAAA")}}," ",l.a.createElement(m.c,null)," ")),l.a.createElement("li",{style:{float:"right"}},l.a.createElement("a",{onClick:function(){u(Object(r.g)({channelIndex:n,sampleIndex:null,showSourcePicker:!0}))}},l.a.createElement("i",{className:"glyphicon glyphicon-plus"})))),g,w)},y=function(e){var t=e.index,n=e.keyZoneMode,a=e.channelAudioType,o=Object(c.c)();function i(e){o(Object(r.i)({index:t,keyZoneMode:n,channelAudioType:e}))}function u(e){o(Object(r.i)({index:t,keyzone_mode:e,channelAudioType:a}))}return l.a.createElement("div",{className:"track-keyzone-mode-menu"},l.a.createElement("div",{className:"track-audio-type-menu-container"},l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return i("sample-trig")},className:"sample-trig"===a?"is-active":""},"Trig")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return i("sample-slice")},className:"sample-slice"===a?"is-active":""},"Slice")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return i("synth")},className:"synth"===a?"is-active":""},"Synth")))),l.a.createElement("div",{style:{opacity:"sample-trig"==a?"1":"0"},className:"keyzone-mode-menu-container"},l.a.createElement("span",null,"Auto Split:"),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return u("all-full")},className:"all-full"===n?"is-active":""},"Off")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return u("split-full")},className:"split-full"===n?"is-active":""},"Auto")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return u("split-narrow")},className:"split-narrow"===n?"is-active":""},"Narrow")))))},g=n(157),w=function(e){var t=e.showEditMode,n=e.setShowEditMode,o=e.title,i=e.index,s=Object(c.c)(),m=Object(a.useState)(o),d=u()(m,2),f=d[0],E=d[1],h=Object(a.useRef)(null),v=Object(a.useRef)(null);function b(e){"Escape"===e.key?h.current.click():"Enter"===e.key&&v.current.click()}Object(a.useEffect)((function(){return window.removeEventListener("keydown",b,!1),window.addEventListener("keydown",b,!1),function(){window.removeEventListener("keydown",b,!1)}}),[o]),Object(a.useEffect)((function(){!0===t&&E(o)}),[t]);var k=Object(a.useRef)();Object(p.d)(k,(function(e){"edit-button"!==e.target.className&&n(!1)}));var O,j=null===o?"Track ".concat(i+1):o;return O=!0===t?l.a.createElement("div",{className:"input-wrapper"},l.a.createElement("input",{type:"text",placeholder:"",value:o,onChange:function(e){return s(Object(r.j)({index:i,title:e.target.value}))},autoFocus:!0}),l.a.createElement("a",{ref:h,className:"undo-title-change",onClick:function(){s(Object(r.j)({index:i,title:f})),n(!1)}},l.a.createElement(g.b,null)),l.a.createElement("a",{ref:v,className:"save-changes",onClick:function(){return E(o),void n(!1)}})):l.a.createElement("h2",null,j),l.a.createElement("div",{className:"sample-set-title"},l.a.createElement("div",{ref:k,className:"title-wrapper"},O))},S=function(e){var t,n=Object(c.c)(),o=e.index,i=e.channel,f=e.color,E=Object(a.useState)(!1),h=u()(E,2),v=h[0],b=h[1],k=Object(a.useState)(!1),O=u()(k,2),g=O[0],S=O[1],N=Object(a.useRef)();return Object(p.d)(N,(function(){return S(!1)})),!0===g&&(t=l.a.createElement("div",{className:"color-picker-container"},l.a.createElement(s.a,{color:f,onChange:function(e){return n(Object(r.h)({index:o,color:e.hex}))}}))),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"sample-set",style:{backgroundColor:e.color}},l.a.createElement("div",{ref:N,className:"edit-menu-container"},l.a.createElement("ul",{className:"edit-menu"},l.a.createElement("li",null,l.a.createElement("a",{className:"edit-button",onClick:function(){return b(1!=v)}},l.a.createElement(d.a,null),l.a.createElement("span",{className:"edit-button"}))),l.a.createElement("li",null,l.a.createElement("a",{className:"color-picker",onClick:function(){return S(1!=g)}},l.a.createElement(m.d,null)))),t),l.a.createElement(w,{showEditMode:v,title:i.name,index:o,setShowEditMode:b}),l.a.createElement(y,{index:o,keyZoneMode:i.keyzone_mode,channelAudioType:i.channelAudioType}),l.a.createElement(j,{index:o,samples:"sample-loop"===i.channelAudioType?i.clips:i.samples,sampleSetMode:i.channelAudioType,keyZoneMode:i.keyzone_mode})))},N=n(370),x=n(158),C=function(e){var t=e.onSelectFile,n=Object(c.c)(),r=Object(c.d)((function(e){return e.filePicker})),i=r.folder,u=r.initFolder,s=r.mode,d=r.files,f=r.selectedFile,E=r.type;Object(a.useEffect)((function(){null!==i&&n(Object(o.b)())}),[i]);var h=Object(a.useRef)();function v(e,a){"LOAD"===s&&function(e,a){"folder"===a||"cache"===a?n(Object(o.e)(e.path+"/")):t(e)}(e,a)}Object(p.d)(h,(function(e){n(Object(o.c)())}));var b="sample-set-load-from-sketch-pad-dialog";"SAVE"===s&&(b+=" w-save");var O,j=l.a.createElement("li",null,l.a.createElement("a",null,"No files of type ".concat(E," were found")));return null!==d&&d.length>0&&(j=d.map((function(e,t){var a=l.a.createElement(m.a,null),c="folder";return e.name.indexOf(".")>-1&&"cache"!==(c=e.name.split(".")[e.name.split(".").length-1])&&(a="wav"===c?l.a.createElement(x.b,null):"json"===c?l.a.createElement(N.a,null):l.a.createElement(x.a,null)),l.a.createElement("li",{key:t},l.a.createElement("a",{onClick:function(){return n(Object(o.f)(e.name))},className:e.name===f?"active":"",onDoubleClick:function(){return v(e,c)}},a," ",e.name))}))),i!==u&&(O=l.a.createElement("li",null,l.a.createElement("a",{onDoubleClick:function(){return e=i.split("/")[i.split("/").length-2]+"/",t=i.split(e)[0],void n(Object(o.e)(t));var e,t}},l.a.createElement(m.b,null),"..."))),l.a.createElement("div",{ref:h,className:b},l.a.createElement("a",{className:"close",onClick:function(){return n(Object(o.c)())}},l.a.createElement(k.f,null)),l.a.createElement("h4",null,s," FROM SKETCH PAD"),l.a.createElement("ul",null,O,j))};t.default=function(e){var t,n=e.colorsArray,i=Object(c.d)((function(e){return e.sampleEditor})),u=i.sketchpadInfo,s=i.sketchpad,m=Object(c.d)((function(e){return e.filePicker})).showFilePicker,d=Object(c.c)();if(Object(a.useEffect)((function(){d(Object(r.c)())}),[]),Object(a.useEffect)((function(){null!==u&&d(Object(r.b)())}),[u]),null!==s){var p=u.lastSelectedSketchpad,f=p.split("/")[p.split("/").length-1],E=p.split(f)[0];E.indexOf("/zynthian/")>-1&&(E="/"+E.split("/zynthian/")[1]),t=s.channels.map((function(e,t){return l.a.createElement(S,{key:t,index:t,color:e.color&&"#000000"!==e.color?e.color:n[t],channel:e})}))}var h,v={height:window.innerHeight-165};return window.innerHeight<865&&(v["overflow-y"]="scroll"),!0===m&&(h=l.a.createElement(C,{onSelectFile:function(e){d(Object(r.k)({filePath:e.path,fileName:e.name}))}})),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"sample-editor-menu"},l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("a",null,"New")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return e=u.lastSelectedSketchpad.split(s.name)[0],void d(Object(o.d)({folder:e,mode:"LOAD",type:".sketchpad.json"}));var e}},"Load")),l.a.createElement("li",null,l.a.createElement("a",{onClick:function(){return d(Object(r.e)())}},"Save")),null!==u?l.a.createElement("li",{style:{float:"right"}},l.a.createElement("a",null,u.lastSelectedSketchpad)):"")),l.a.createElement("div",{id:"sample-editor",style:v},t),h)}},76:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return m}));var a=n(10),l=n.n(a),c=(n(83),n(0));function r(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=t?1e3:1024;if(Math.abs(e)<a)return e+" B";var l=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],c=-1,r=Math.pow(10,n);do{e/=a,++c}while(Math.round(Math.abs(e)*r)/r>=a&&c<l.length-1);return e.toFixed(n)+" "+l[c]}function o(e,t){Object(c.useEffect)((function(){var n=function(n){e.current&&!e.current.contains(n.target)&&t(n)};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),function(){document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,t])}function i(e){var t=Object(c.useRef)();return Object(c.useEffect)((function(){t.current=e}),[e]),t.current}var u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.shouldPreventDefault,r=void 0===a||a,o=n.delay,i=void 0===o?300:o,u=Object(c.useState)(!1),m=l()(u,2),d=m[0],p=m[1],f=Object(c.useRef)(),E=Object(c.useRef)(),h=Object(c.useCallback)((function(t){r&&t.target&&(t.target.addEventListener("touchend",s,{passive:!1}),E.current=t.target),f.current=setTimeout((function(){e(t),p(!0)}),i)}),[e,i,r]),v=Object(c.useCallback)((function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];f.current&&clearTimeout(f.current),n&&!d&&t(),p(!1),r&&E.current&&E.current.removeEventListener("touchend",s)}),[r,t,d]);return{onMouseDown:function(e){return h(e)},onTouchStart:function(e){return h(e)},onMouseUp:function(e){return v(e)},onMouseLeave:function(e){return v(e,!1)},onTouchEnd:function(e){return v(e)}}},s=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()};function m(e){var t=Math.floor(e/60),n=e-60*t;return t<10&&(t="0"+t),(n=Math.floor(n))<10&&(n="0"+n),t+":"+n}}}]);