(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{377:function(e,t,n){"use strict";n.r(t);var a=n(34),r=n.n(a),i=n(2),l=n.n(i),o=n(35),c=n.n(o),s=n(0),u=n.n(s),p=n(93),f=n(6),d=n.n(f),m=n(1),h=n.n(m),E=n(74),w=n.n(E),b=n(137),v=n(370),y=n(134),g=n(369),F=n(68),O=n(39);var j=function(e){var t=e.file,n=e.index,a=e.uploadProgress,r=a;return a>0&&(r=parseInt(100*a/t.size)),u.a.createElement("div",{className:"file-uploader-list-item"},u.a.createElement("div",{className:"list-item-file-info"},u.a.createElement("span",{className:"file-name"},t.path),u.a.createElement("span",{className:"file-size"},Object(O.a)(t.size))),u.a.createElement("div",{className:"list-item-progress-container"},u.a.createElement("div",{className:"list-item-progress-bar",style:{width:r+"%"}},u.a.createElement("span",null,Object(O.a)(a)))),u.a.createElement("div",{className:"list-item-actions"},u.a.createElement("a",{className:"button",onClick:function(){return e.renameFile(n)}},u.a.createElement(y.a,null)),u.a.createElement("a",{className:"button",onClick:function(){return e.uploadFile(n)}},u.a.createElement(g.a,null)),u.a.createElement("a",{className:"button",onClick:function(){return e.removeFile(n)}},u.a.createElement(v.a,null))))},x=function(e){var t=e.selectedFolder,n=e.fsep,a=Object(s.useCallback)((function(e){var t=[];for(var n in e)t[n]=null!==C?C[n]:0;D(t),y(e)}),[]),i=Object(b.b)({onDrop:a}),o=i.getRootProps,p=i.getInputProps,f=i.isDragActive,m=Object(s.useState)(null),E=l()(m,2),v=E[0],y=E[1],g=Object(s.useState)(""),O=l()(g,2),x=O[0],S=O[1],N=Object(s.useState)(null),k=l()(N,2),C=k[0],D=k[1],T=Object(s.useState)(!1),P=l()(T,2),M=P[0],R=P[1],U=Object(s.useState)(null),I=l()(U,2),_=I[0],H=I[1];Object(s.useEffect)((function(){null!==v&&(document.getElementById("file-uploader").offsetHeight<37*(v.length+1)?S(" w-scroll"):S(""))}),[v]),Object(s.useEffect)((function(){!0===M&&H(0)}),[M]),Object(s.useEffect)((function(){null!==_&&V(_,!0)}),[_]);var A,L,z=function(e){},J=function(e){var t=[].concat(h()(v.slice(0,e)),h()(v.slice(e+1,v.length)));y(t)},V=function(a){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t+v[a].path.split(v[a].name)[0],l="http://".concat(window.location.hostname,":3000/upload/").concat(i.split(n).join("+++")),o=new FormData;o.append("file",v[a]);var c={onUploadProgress:function(e){var t=[].concat(h()(C.slice(0,a)),[e.loaded],h()(C.slice(a+1,C.length)));D(t)}};w.a.post(l,o,c).then((function(t){!0===r&&(a+1<v.length?H(a+1):(e.setShowFileUploader(!1),e.refreshFileManager(t.data)))}))},B=function(){var e=r()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:R(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(v&&v.length>0){var q=v.map((function(e,t){return u.a.createElement(j,{key:t,index:t,file:e,uploadProgress:C[t],renameFile:z,removeFile:J,uploadFile:V})}));A=u.a.createElement("div",{id:"file-uploader-summary-list"},u.a.createElement("div",{id:"file-list",className:x},q),u.a.createElement("div",{id:"file-list-actions"},u.a.createElement("div",{style:{float:"right"}},u.a.createElement("div",{className:"upload-items-counter"},null!==_?_+" / "+v.length+" Total":""),u.a.createElement("a",{className:"button",onClick:function(){return e.setShowFileUploader(!1)}},"Close"),u.a.createElement("a",{className:"button",onClick:B}," Upload Files "))))}else L=u.a.createElement("div",d()({className:"dropzone-container"},o()),u.a.createElement("input",d()({},p(),{name:"file"})),f?u.a.createElement("p",null,"Drop the files here ..."):u.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files"));return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{id:"file-uploader"},u.a.createElement("a",{className:"close-file-uploader",onClick:function(){return e.setShowFileUploader(!1)}},u.a.createElement(F.a,null)),L,A))},S=n(371),N=n.n(S),k=n(4),C=function(e){var t=e.file,n=e.setShowFileViewer,a=Object(s.useRef)();Object(O.b)(a,(function(){return n(!1)}));var i=t.path.split(".")[t.path.split(".").length-1],o=Object(s.useState)(null),p=l()(o,2),f=p[0],d=p[1],m=Object(s.useState)(!0),h=l()(m,2),E=h[0],w=h[1];function b(){return(b=r()(c.a.mark((function e(){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://".concat(window.location.hostname,":3000/json/").concat(t.path.split("/").join("+++")),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,e.next=5,n.json();case 5:a=e.sent,console.log(a," JSON RES "),d(a),w(!1);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(s.useEffect)((function(){"json"===i&&function(){b.apply(this,arguments)}()}),[]);var v=u.a.createElement(k.a,null);return"json"===i&&!1===E&&(v=u.a.createElement("div",{className:"json-viewer-container"},u.a.createElement(N.a,{src:f}))),u.a.createElement("div",{ref:a,id:"file-viewer"},u.a.createElement("a",{className:"close-file-viewer",onClick:function(){return n(!1)}},u.a.createElement(F.a,null)),v)},D=n(373),T=n(372),P=n(67),M=n(7);var R=function(e){var t=Object(s.useContext)(M.a),n=t.fileManagerState,a=t.fileManagerDispatch,r=n.browseHistory,i=n.browseHistoryIndex,o=e.getFiles,c=Object(s.useState)(!1),f=l()(c,2),d=f[0],m=f[1];Object(s.useEffect)((function(){setTimeout((function(){var e=document.getElementsByClassName("fa-level-up-alt")[0];e&&null!==e&&e.setAttribute("transform","scale(-1 1)");var t=document.evaluate("//span[text()='Actions']",document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;t.innerText="More ...",console.log(t)}),10)}),[]);var h,E=Object(s.useRef)();function w(e){var t;"number"==typeof(t="back"===e&&n.browseHistoryIndex-1>=0?n.browseHistoryIndex-1:"forward"===e&&n.browseHistoryIndex+1<=n.browseHistory.length-1?n.browseHistoryIndex+1:e)&&a({type:"SET_SELECTED_FOLDER",payload:n.browseHistory[t],isViewingHistory:!0,browseHistoryIndex:t})}if(Object(O.b)(E,(function(){return m(!1)})),!0===d){var b=r.map((function(e,t){var n,a="/home/pi/"===e.path?"zynthian":e.path.indexOf("/home/pi/")>-1?"zynthian/"+e.path.split("/home/pi/")[1]:e.path;return t===i&&(n="active"),u.a.createElement("li",null,u.a.createElement("a",{className:n,title:e.path,onClick:function(){return w(t)}},a))}));h=u.a.createElement("div",{ref:E,className:"browser-history-submenu"},u.a.createElement("a",{onClick:function(){return m(!1)},className:"close-browser-history"},u.a.createElement(P.e,null)),u.a.createElement("ul",null,b))}return u.a.createElement("div",{className:"file-navbar-container-custom"},u.a.createElement("ul",{className:"browser-navigation-menu"},u.a.createElement("li",null,u.a.createElement("a",{onClick:function(){return m(!0)}},u.a.createElement(T.a,null))),u.a.createElement("li",null,u.a.createElement("a",{onClick:function(){return w("back")}},u.a.createElement(D.a,null))),u.a.createElement("li",null,u.a.createElement("a",{onClick:function(){return w("forward")}},u.a.createElement(D.b,null)))),h,u.a.createElement(p.f,null),u.a.createElement("a",{className:"refresh-button",onClick:function(){return o()}},u.a.createElement("span",null,"Refresh"),u.a.createElement(D.c,null)))};t.default=function(e){var t=Object(s.useContext)(M.a),n=t.fileManagerState,a=t.fileManagerDispatch,i=n.displayedFiles,o=n.selectedFolder,f=n.folderChain,d=(n.ffolder,e.fsep),m=Object(s.useState)(""),h=l()(m,2),E=h[0],w=h[1],b=Object(s.useState)(""),v=l()(b,2),y=v[0],g=v[1],F=Object(s.useState)(!1),O=l()(F,2),j=O[0],S=O[1],N=Object(s.useState)(!1),D=l()(N,2),T=D[0],P=D[1],U=Object(s.useState)(""),I=l()(U,2),_=I[0],H=I[1],A=Object(s.useState)(""),L=l()(A,2),z=L[0],J=L[1],V=Object(s.useState)(""),B=l()(V,2),q=B[0],G=B[1],X=Object(s.useRef)(null);function Y(){X.current&&X.current.requestFileAction(p.a.ClearSelection)}function K(){var e=window.prompt("Enter new Folder Name:");null!==e&&function(e){Q.apply(this,arguments)}((null!==o?o+d:"")+e)}function Q(){return(Q=r()(c.a.mark((function t(n){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://".concat(window.location.hostname,":3000/createfolder"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullPath:n})});case 2:return a=t.sent,t.next=5,a.json();case 5:t.sent,e.getFiles();case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function W(e){var t=e.state.selectedFiles[0].path,n=t.split("/")[t.split("/").length-1],r=window.prompt('Enter new name for "'.concat(n,'":'),n);if(null!==r){var i=null===o?"/home/pi/"+r:t.split(o)[0]+o+"/"+r;a({type:"RENAME_FILE",payload:{previousPath:t,fullPath:i}}),function(e,t){Z.apply(this,arguments)}(t,i)}}function Z(){return(Z=r()(c.a.mark((function t(n,a){var r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://".concat(window.location.hostname,":3000/rename"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullPath:a,previousPath:n})});case 2:return r=t.sent,t.next=5,r.json();case 5:i=t.sent,e.getFiles(i);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $(e,t){return ee.apply(this,arguments)}function ee(){return(ee=r()(c.a.mark((function t(n,a){var i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=n[a],fetch("http://".concat(window.location.hostname,":3000/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullPath:i})}).then(function(){var t=r()(c.a.mark((function t(r){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a!==n.length-1){t.next=10;break}return t.next=3,r.json();case 3:t.sent,Y(),P(!1),H(""),e.getFiles(),t.next=11;break;case 10:$(n,a+1);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function te(){return(te=r()(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],t.state.selectedFiles.forEach((function(e,t){n.push(e.path)})),H("Preparing Download"),P(!0),n.forEach(function(){var e=r()(c.a.mark((function e(t,n){var a,r,i,l,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://".concat(window.location.hostname,":3000/download"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:t})});case 2:return a=e.sent,e.next=5,a.blob();case 5:r=e.sent,i=window.URL.createObjectURL(r),(l=document.createElement("a")).href=i,-1===(o=t.split(d)[t.split(d).length-1]).indexOf(".zip")&&"application/zip"===r.type&&(o+=".zip"),l.download=o,document.body.appendChild(l),l.click(),l.remove(),P(!1),H("");case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e,t,n){return ae.apply(this,arguments)}function ae(){return(ae=r()(c.a.mark((function e(t,n,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:H("Copying Files"),P(!0),re(t,n,a,0);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e,t,n,a){return ie.apply(this,arguments)}function ie(){return(ie=r()(c.a.mark((function t(n,a,i,l){var o,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=n[l],s=a[l],fetch("http://".concat(window.location.hostname,":3000/copypaste"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({previousPath:o,destinationPath:s,deleteOrigin:i})}).then(function(){var t=r()(c.a.mark((function t(r){var o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l!==n.length-1){t.next=10;break}return t.next=3,r.json();case 3:o=t.sent,Y(),P(!1),H(""),e.refreshFileManager(o),t.next=11;break;case 10:re(n,a,i,l+1);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var le,oe,ce,se,ue=Object(p.h)({id:"create_files",button:{name:"Add Folder",toolbar:!0,contextMenu:!0,icon:p.b.folderCreate}}),pe=Object(p.h)({id:"edit_files",button:{name:"Edit",contextMenu:!0,icon:p.b.archive}}),fe=Object(p.h)({id:"rename_files",button:{name:"Rename",contextMenu:!0,icon:p.b.code}}),de=Object(p.h)({id:"paste_files",button:{name:"Paste",contextMenu:!0,icon:p.b.paste}}),me=Object(p.h)({id:p.a.UploadFiles.id,button:{name:"Upload",toolbar:!0,contextMenu:!0,icon:p.b.upload}}),he=Object(p.h)({id:p.a.DownloadFiles.id,button:{name:"Download",toolbar:!0,contextMenu:!0,icon:p.b.download}}),Ee=[ue,pe,fe,me,he,p.a.DeleteFiles,p.a.CopyFiles,p.a.StartDragNDrop,p.a.EndDragNDrop,de];return!0===e.showFileUploader&&(oe=u.a.createElement(u.a.Fragment,null,u.a.createElement(x,{selectedFolder:o,fsep:d,refreshFileManager:e.refreshFileManager,setShowFileUploader:e.setShowFileUploader}))),!0===T&&(ce=u.a.createElement("div",{className:"file-browser-loading-spinner-container"},u.a.createElement(k.a,{text:_}))),!0===z&&(se=u.a.createElement(C,{file:q,setShowFileViewer:J})),u.a.createElement("div",{style:{height:window.innerHeight-170,position:"relative"},onDragOver:function(){!1===j&&(clearTimeout(le),e.setShowFileUploader(!0))},onDragLeave:function(){le=setTimeout((function(){e.setShowFileUploader(!1)}),10)}},ce,oe,se,u.a.createElement(p.c,{files:i,folderChain:f,fileActions:Ee,onFileAction:function(t){var n;t.id===p.a.OpenFiles.id&&function(e){var t=e.payload.files[0];!0===t.isDir?a({type:"SET_SELECTED_FOLDER",payload:t}):t.path.indexOf(".")>-1&&"json"===t.path.split(".")[t.path.split(".").length-1]&&(G(t),J(!0))}(t),t.id===ue.id&&K(),t.id===pe.id&&alert("Edit Folder Action"),t.id===fe.id&&W(t),t.id===p.a.UploadFiles.id&&e.setShowFileUploader(!0),t.id===p.a.DownloadFiles.id&&function(e){te.apply(this,arguments)}(t),t.id===p.a.DeleteFiles.id&&function(e){var t="are you sure you want to delete following files? \n",n=[];e.state.selectedFilesForAction.forEach((function(e,a){n.push(e.path),t+=e.path+"\n"})),window.confirm(t)&&(H("Deleting Files"),P(!0),a({type:"DELETE_FILES",payload:n}),$(n,0))}(t),t.id===p.a.CopyFiles.id&&function(e){var t=[];e.state.selectedFiles.forEach((function(e,n){t.push(e.path)})),w(t)}(t),t.id===de.id&&(n=[],E.forEach((function(e,t){var a=o+d;e.indexOf(".")>-1&&(a=o+d+e.split(d)[e.split(d).length-1]),n.push(a)})),ne(E,n)),t.id===p.a.StartDragNDrop.id&&function(e){S(!0);var t=[];e.state.selectedFiles.forEach((function(e,n){t.push(e.path)})),g(t)}(t),t.id===p.a.EndDragNDrop.id&&function(e){S(!1);var t=[];y.forEach((function(n,a){var r=o+e.payload.destination.path.split(o)[1];n.indexOf(".")>-1&&(r+=d+n.split(d)[n.split(d).length-1]),t.push(r)})),ne(y,t,!0)}(t)},defaultFileViewActionId:p.a.EnableListView.id,clearSelectionOnOutsideClick:!0,ref:X},u.a.createElement(R,{getFiles:e.getFiles}),u.a.createElement(p.g,null),u.a.createElement(p.e,null),u.a.createElement(p.d,null)))}}}]);