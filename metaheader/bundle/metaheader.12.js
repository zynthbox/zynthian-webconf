(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{423:function(e,t,n){"use strict";n.r(t);var a=n(34),i=n.n(a),l=n(2),r=n.n(l),o=n(35),c=n.n(o),s=n(0),u=n.n(s),p=n(94),f=n(6),d=n.n(f),h=n(1),m=n.n(h),E=n(58),w=n.n(E),b=n(139),v=n(372),y=n(135),g=n(371),F=n(70),O=n(39);var j=function(e){var t=e.file,n=e.index,a=e.uploadProgress,i=a;return a>0&&(i=parseInt(100*a/t.size)),u.a.createElement("div",{className:"file-uploader-list-item"},u.a.createElement("div",{className:"list-item-file-info"},u.a.createElement("span",{className:"file-name"},t.path),u.a.createElement("span",{className:"file-size"},Object(O.a)(t.size))),u.a.createElement("div",{className:"list-item-progress-container"},u.a.createElement("div",{className:"list-item-progress-bar",style:{width:i+"%"}},u.a.createElement("span",null,Object(O.a)(a)))),u.a.createElement("div",{className:"list-item-actions"},u.a.createElement("a",{className:"button",onClick:function(){return e.renameFile(n)}},u.a.createElement(y.a,null)),u.a.createElement("a",{className:"button",onClick:function(){return e.uploadFile(n)}},u.a.createElement(g.a,null)),u.a.createElement("a",{className:"button",onClick:function(){return e.removeFile(n)}},u.a.createElement(v.a,null))))},S=function(e){var t=e.selectedFolder,n=e.fsep,a=Object(s.useCallback)((function(e){var t=[];for(var n in e)t[n]=null!==k?k[n]:0;C(t),y(e)}),[]),l=Object(b.b)({onDrop:a}),o=l.getRootProps,p=l.getInputProps,f=l.isDragActive,h=Object(s.useState)(null),E=r()(h,2),v=E[0],y=E[1],g=Object(s.useState)(""),O=r()(g,2),S=O[0],x=O[1],N=Object(s.useState)(null),D=r()(N,2),k=D[0],C=D[1],T=Object(s.useState)(!1),P=r()(T,2),L=P[0],R=P[1],I=Object(s.useState)(null),U=r()(I,2),M=U[0],_=U[1];Object(s.useEffect)((function(){null!==v&&(document.getElementById("file-uploader").offsetHeight<37*(v.length+1)?x(" w-scroll"):x(""))}),[v]),Object(s.useEffect)((function(){!0===L&&_(0)}),[L]),Object(s.useEffect)((function(){null!==M&&V(M,!0)}),[M]);var A,H,z=function(e){},J=function(e){var t=[].concat(m()(v.slice(0,e)),m()(v.slice(e+1,v.length)));y(t)},V=function(a){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l="/";null!==t&&(l="/"===t.slice(-1)?t:t+"/");var r=l+v[a].path.split(v[a].name)[0],o="http://".concat(window.location.hostname,":3000/upload/").concat(r.split(n).join("+++")),c=new FormData;c.append("file",v[a]);var s={onUploadProgress:function(e){var t=[].concat(m()(k.slice(0,a)),[e.loaded],m()(k.slice(a+1,k.length)));C(t)}};w.a.post(o,c,s).then((function(t){!0===i&&(a+1<v.length?_(a+1):(e.setShowFileUploader(!1),e.refreshFileManager(t.data)))}))},G=function(){var e=i()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:R(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(v&&v.length>0){var B=v.map((function(e,t){return u.a.createElement(j,{key:t,index:t,file:e,uploadProgress:k[t],renameFile:z,removeFile:J,uploadFile:V})}));A=u.a.createElement("div",{id:"file-uploader-summary-list"},u.a.createElement("div",{id:"file-list",className:S},B),u.a.createElement("div",{id:"file-list-actions"},u.a.createElement("div",{style:{float:"right"}},u.a.createElement("div",{className:"upload-items-counter"},null!==M?M+" / "+v.length+" Total":""),u.a.createElement("a",{className:"button",onClick:function(){return e.setShowFileUploader(!1)}},"Close"),u.a.createElement("a",{className:"button",onClick:G}," Upload Files "))))}else H=u.a.createElement("div",d()({className:"dropzone-container"},o()),u.a.createElement("input",d()({},p(),{name:"file"})),f?u.a.createElement("p",null,"Drop the files here ..."):u.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files"));return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{id:"file-uploader"},u.a.createElement("a",{className:"close-file-uploader",onClick:function(){return e.setShowFileUploader(!1)}},u.a.createElement(F.a,null)),H,A))},x=n(377),N=n(373),D=n.n(N),k=n(4),C=function(e){var t=e.file,n=e.setShowFileViewer,a=(e.selectedFolder,Object(s.useRef)());Object(O.b)(a,(function(){return n(!1)}));var l=t.path.split(".")[t.path.split(".").length-1],o=Object(s.useState)(null),p=r()(o,2),f=p[0],d=p[1],h=Object(s.useState)(!0),m=r()(h,2),E=m[0],b=m[1];function v(){return(v=i()(c.a.mark((function e(){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://".concat(window.location.hostname,":3000/json/").concat(t.path.split("/").join("+++")),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,e.next=5,n.json();case 5:a=e.sent,console.log(a," GET JSON RES"),d(a),b(!1);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=i()(c.a.mark((function e(n){var a,i,l,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new File([n],t.name,{type:"application/json"}),(i=new FormData).append("file",a,t.name),l=t.path.split("/home/pi")[1].split(t.name)[0],r="http://".concat(window.location.hostname,":3000/upload/").concat(l.split("/").join("+++")),w.a.post(r,i).then((function(e){console.log("JSON UPDATED!"),console.log(e," RES ")}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(s.useEffect)((function(){"json"===l&&function(){v.apply(this,arguments)}()}),[]);var g=u.a.createElement(k.a,null);return"json"===l&&!1===E&&(g=u.a.createElement("div",{className:"json-viewer-container"},u.a.createElement(x.a,{id:t.path,placeholder:f,locale:D.a,height:"100%",width:"100%",onChange:function(e){!function(e){y.apply(this,arguments)}(e.json)}}))),u.a.createElement("div",{ref:a,id:"file-viewer"},u.a.createElement("a",{className:"close-file-viewer",onClick:function(){return n(!1)}},u.a.createElement(F.a,null)),g)},T=n(375),P=n(374),L=n(69),R=n(7);var I=function(e){var t=Object(s.useContext)(R.a),n=t.fileManagerState,a=t.fileManagerDispatch,i=n.browseHistory,l=n.browseHistoryIndex,o=e.getFiles,c=Object(s.useState)(!1),f=r()(c,2),d=f[0],h=f[1];Object(s.useEffect)((function(){setTimeout((function(){var e=document.getElementsByClassName("fa-level-up-alt")[0];e&&null!==e&&e.setAttribute("transform","scale(-1 1)");document.evaluate("//span[text()='Actions']",document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue.innerText="More..."}),10)}),[]);var m,E=Object(s.useRef)();function w(e){var t;"number"==typeof(t="back"===e&&n.browseHistoryIndex-1>=0?n.browseHistoryIndex-1:"forward"===e&&n.browseHistoryIndex+1<=n.browseHistory.length-1?n.browseHistoryIndex+1:e)&&a({type:"SET_SELECTED_FOLDER",payload:n.browseHistory[t],isViewingHistory:!0,browseHistoryIndex:t})}if(Object(O.b)(E,(function(){return h(!1)})),!0===d){var b=i.map((function(e,t){var n,a="/home/pi/"===e.path?"zynthian":e.path.indexOf("/home/pi/")>-1?"zynthian/"+e.path.split("/home/pi/")[1]:e.path;return t===l&&(n="active"),u.a.createElement("li",null,u.a.createElement("a",{className:n,title:e.path,onClick:function(){return w(t)}},a))}));m=u.a.createElement("div",{ref:E,className:"browser-history-submenu"},u.a.createElement("a",{onClick:function(){return h(!1)},className:"close-browser-history"},u.a.createElement(L.e,null)),u.a.createElement("ul",null,b))}return u.a.createElement("div",{className:"file-navbar-container-custom"},u.a.createElement("ul",{className:"browser-navigation-menu"},u.a.createElement("li",null,u.a.createElement("a",{onClick:function(){return h(!0)}},u.a.createElement(P.a,null))),u.a.createElement("li",null,u.a.createElement("a",{onClick:function(){return w("back")}},u.a.createElement(T.a,null))),u.a.createElement("li",null,u.a.createElement("a",{onClick:function(){return w("forward")}},u.a.createElement(T.b,null)))),m,u.a.createElement(p.f,null),u.a.createElement("a",{className:"refresh-button",onClick:function(){a({type:"ON_REFRESH_FILES"}),o()}},u.a.createElement(T.c,null),u.a.createElement("span",null,"Refresh")))};t.default=function(e){var t=Object(s.useContext)(R.a),n=t.fileManagerState,a=t.fileManagerDispatch,l=n.displayedFiles,o=n.selectedFolder,f=n.folderChain,d=(n.ffolder,e.fsep),h=Object(s.useState)(""),m=r()(h,2),E=m[0],w=m[1],b=Object(s.useState)(""),v=r()(b,2),y=v[0],g=v[1],F=Object(s.useState)(!1),O=r()(F,2),j=O[0],x=O[1],N=Object(s.useState)(!1),D=r()(N,2),T=D[0],P=D[1],L=Object(s.useState)(""),U=r()(L,2),M=U[0],_=U[1],A=Object(s.useState)(""),H=r()(A,2),z=H[0],J=H[1],V=Object(s.useState)(""),G=r()(V,2),B=G[0],Y=G[1],q=Object(s.useRef)(null);function X(){q.current&&q.current.requestFileAction(p.a.ClearSelection)}function K(){var e=window.prompt("Enter new Folder Name:");null!==e&&function(e){Q.apply(this,arguments)}((null!==o?o+d:"")+e)}function Q(){return(Q=i()(c.a.mark((function t(n){var a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://".concat(window.location.hostname,":3000/createfolder"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullPath:n})});case 2:return a=t.sent,t.next=5,a.json();case 5:t.sent,e.getFiles();case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function W(e){var t=e.state.selectedFiles[0].path,n=t.split("/")[t.split("/").length-1],i=window.prompt('Enter new name for "'.concat(n,'":'),n);if(null!==i){var l=null===o?"/home/pi/"+i:t.split(o)[0]+o+"/"+i;a({type:"RENAME_FILE",payload:{previousPath:t,fullPath:l}}),function(e,t){Z.apply(this,arguments)}(t,l)}}function Z(){return(Z=i()(c.a.mark((function t(n,a){var i,l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("http://".concat(window.location.hostname,":3000/rename"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullPath:a,previousPath:n})});case 2:return i=t.sent,t.next=5,i.json();case 5:l=t.sent,e.getFiles(l);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $(e,t){return ee.apply(this,arguments)}function ee(){return(ee=i()(c.a.mark((function t(n,a){var l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=n[a],fetch("http://".concat(window.location.hostname,":3000/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullPath:l})}).then(function(){var t=i()(c.a.mark((function t(i){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a!==n.length-1){t.next=10;break}return t.next=3,i.json();case 3:t.sent,X(),P(!1),_(""),e.getFiles(),t.next=11;break;case 10:$(n,a+1);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function te(){return(te=i()(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],t.state.selectedFiles.forEach((function(e,t){n.push(e.path)})),n.length>0&&(_("Preparing Download"),P(!0),n.forEach(function(){var e=i()(c.a.mark((function e(t,n){var a,i,l,r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://".concat(window.location.hostname,":3000/download"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:t})});case 2:return a=e.sent,e.next=5,a.blob();case 5:i=e.sent,l=window.URL.createObjectURL(i),(r=document.createElement("a")).href=l,-1===(o=t.split(d)[t.split(d).length-1]).indexOf(".zip")&&"application/zip"===i.type&&(o+=".zip"),r.download=o,document.body.appendChild(r),r.click(),r.remove(),P(!1),_("");case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e,t,n){return ae.apply(this,arguments)}function ae(){return(ae=i()(c.a.mark((function e(t,n,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_("Copying Files"),P(!0),console.log(t,n),ie(t,n,a,0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e,t,n,a){return le.apply(this,arguments)}function le(){return(le=i()(c.a.mark((function t(n,l,r,o){var s,u;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("COPY PASTE FILES"),s=n[o],u=l[o],fetch("http://".concat(window.location.hostname,":3000/copypaste"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({previousPath:s,destinationPath:"/"+u,deleteOrigin:r})}).then(function(){var t=i()(c.a.mark((function t(i){var s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o!==n.length-1){t.next=11;break}return!0===r&&a({type:"DELETE_FILES",payload:n}),t.next=4,i.json();case 4:s=t.sent,X(),P(!1),_(""),e.refreshFileManager(s),t.next=12;break;case 11:ie(n,l,r,o+1);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var re,oe,ce,se,ue=Object(p.h)({id:"create_files",button:{name:"Add Folder",toolbar:!0,contextMenu:!0,icon:p.b.folderCreate}}),pe=Object(p.h)({id:"edit_files",button:{name:"Edit",contextMenu:!0,icon:p.b.archive}}),fe=Object(p.h)({id:"rename_files",button:{name:"Rename",contextMenu:!0,icon:p.b.code}}),de=Object(p.h)({id:"paste_files",button:{name:"Paste",contextMenu:!0,icon:p.b.paste}}),he=Object(p.h)({id:p.a.UploadFiles.id,button:{name:"Upload",toolbar:!0,contextMenu:!1,icon:p.b.upload}}),me=Object(p.h)({id:p.a.DownloadFiles.id,button:{name:"Download",toolbar:!0,contextMenu:!0,icon:p.b.download}}),Ee=[ue,pe,fe,he,me,p.a.DeleteFiles,p.a.CopyFiles,p.a.StartDragNDrop,p.a.EndDragNDrop,de];return!0===z&&(oe=u.a.createElement(C,{file:B,setShowFileViewer:J,selectedFolder:o})),!0===e.showFileUploader&&(ce=u.a.createElement(u.a.Fragment,null,u.a.createElement(S,{selectedFolder:o,fsep:d,refreshFileManager:e.refreshFileManager,setShowFileUploader:e.setShowFileUploader}))),!0!==T&&!0!==n.filesLoading||(console.log(n.filesLoading," FILES LOADING"),se=u.a.createElement("div",{className:"file-browser-loading-spinner-container"},u.a.createElement(k.a,{text:M}))),u.a.createElement("div",{style:{height:window.innerHeight-170,position:"relative"},onDragOver:function(){!1===j&&(clearTimeout(re),e.setShowFileUploader(!0))},onDragLeave:function(){re=setTimeout((function(){e.setShowFileUploader(!1)}),10)}},se,ce,oe,u.a.createElement(p.c,{files:l,folderChain:f,fileActions:Ee,onFileAction:function(t){var n;t.id===p.a.OpenFiles.id&&function(e){var t=e.payload.files[0];!0===t.isDir?a({type:"SET_SELECTED_FOLDER",payload:t}):t.path.indexOf(".")>-1&&"json"===t.path.split(".")[t.path.split(".").length-1]&&(Y(t),J(!0))}(t),t.id===ue.id&&K(),t.id===pe.id&&alert("Edit Folder Action"),t.id===fe.id&&W(t),t.id===p.a.UploadFiles.id&&e.setShowFileUploader(!0),t.id===p.a.DownloadFiles.id&&function(e){te.apply(this,arguments)}(t),t.id===p.a.DeleteFiles.id&&function(e){var t="are you sure you want to delete following files? \n",n=[];e.state.selectedFilesForAction.forEach((function(e,a){n.push(e.path),t+=e.path+"\n"})),window.confirm(t)&&(_("Deleting Files"),P(!0),a({type:"DELETE_FILES",payload:n}),$(n,0))}(t),t.id===p.a.CopyFiles.id&&function(e){var t=[];e.state.selectedFiles.forEach((function(e,n){t.push(e.path)})),w(t)}(t),t.id===de.id&&(n=[],E.forEach((function(e,t){var a=o+d;e.indexOf(".")>-1&&(a=(null!==o?o+d:"")+e.split(d)[e.split(d).length-1]),n.push(a)})),ne(E,n)),t.id===p.a.StartDragNDrop.id&&function(e){x(!0);var t=[];e.state.selectedFiles.forEach((function(e,n){t.push(e.path)})),g(t)}(t),t.id===p.a.EndDragNDrop.id&&function(e){x(!1);var t=[];y.forEach((function(t,n){var a="";a=null!==o?o+e.payload.destination.path.split(o)[1]:e.payload.destination.path.split("/home/pi/")[1],t.indexOf(".")>-1&&(a+=d+t.split(d)[t.split(d).length-1]).indexOf("undefined")>-1&&(a=a.split("undefined").join(""))})),y.length>0&&t.length>0&&ne(y,t,!0)}(t)},defaultFileViewActionId:p.a.EnableListView.id,clearSelectionOnOutsideClick:!0,ref:q,disableDefaultFileActions:[p.a.OpenSelection.id]},u.a.createElement(I,{getFiles:e.getFiles}),u.a.createElement(p.g,null),u.a.createElement(p.e,null),u.a.createElement(p.d,null)))}}}]);