"use strict";(self.webpackChunkzynthbox_webconf_metaheader=self.webpackChunkzynthbox_webconf_metaheader||[]).push([[428],{6087:(e,n,t)=>{t.d(n,{D9:()=>o,TA:()=>i,gB:()=>c,t$:()=>r,ut:()=>u});var a=t(885),l=t(7294);function c(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=n?1e3:1024;if(Math.abs(e)<a)return e+" B";var l=n?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],c=-1,r=Math.pow(10,t);do{e/=a,++c}while(Math.round(Math.abs(e)*r)/r>=a&&c<l.length-1);return e.toFixed(t)+" "+l[c]}function r(e,n){(0,l.useEffect)((function(){var t=function(t){e.current&&!e.current.contains(t.target)&&n(t)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),function(){document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}}),[e,n])}function o(e){var n=(0,l.useRef)();return(0,l.useEffect)((function(){n.current=e}),[e]),n.current}var i=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=t.shouldPreventDefault,r=void 0===c||c,o=t.delay,i=void 0===o?300:o,u=(0,l.useState)(!1),m=(0,a.Z)(u,2),d=m[0],p=m[1],f=(0,l.useRef)(),E=(0,l.useRef)(),h=(0,l.useCallback)((function(n){r&&n.target&&(n.target.addEventListener("touchend",s,{passive:!1}),E.current=n.target),f.current=setTimeout((function(){e(n),p(!0)}),i)}),[e,i,r]),v=(0,l.useCallback)((function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];f.current&&clearTimeout(f.current),t&&!d&&n(),p(!1),r&&E.current&&E.current.removeEventListener("touchend",s)}),[r,n,d]);return{onMouseDown:function(e){return h(e)},onTouchStart:function(e){return h(e)},onMouseUp:function(e){return v(e)},onMouseLeave:function(e){return v(e,!1)},onTouchEnd:function(e){return v(e)}}},s=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()};function u(e){var n=Math.floor(e/60),t=e-60*n;return n<10&&(n="0"+n),(t=Math.floor(t))<10&&(t="0"+t),n+":"+t}},7428:(e,n,t)=>{t.r(n),t.d(n,{default:()=>N});var a=t(7294),l=t(8216),c=t(1911),r=t(9200),o=t(885),i=t(7830),s=t(8193),u=t(5434),m=t(6087),d=t(2298);const p=function(e){var n,t,c,r=e.index,i=e.sample,s=e.channelIndex,u=e.sampleSetMode,m=e.onRemoveSample,p=e.onAddSample,f=(e.uploadSample,e.setLoadFromSketchPadSampleIndex,e.setLoadFromSketchPadFileType,e.setShowSampleSetSourcePicker,(0,a.useState)(!1)),E=(0,o.Z)(f,2),h=E[0],v=E[1],k=(0,l.v9)((function(e){return e.sampleEditor})),y=k.sketchpadInfo,g=k.sketchpad,S=(0,a.useState)(null),w=(0,o.Z)(S,2),x=w[0],N=w[1];function I(){v(!1),document.getElementById("sample-".concat(s+1,"-").concat(r+1,"-audio-player")).pause()}function C(e){var n=e.target;n.currentTime>=n.duration&&I()}(0,a.useEffect)((function(){if(i&&i.path){var e=null,n=(0,d.jE)(y.lastSelectedSketchpad,g.name),t=n.substring(n.indexOf("zynthian-my-data"));t=t.split("/Autosave.sketchpad.json")[0],"sample-trig"==u?e="http://".concat(window.location.hostname,":3000/").concat(t,"/wav/sampleset/sample-bank.").concat(s+1,"/").concat(i.path):"synth"!=u&&"sample-loop"!=u||(e="http://".concat(window.location.hostname,":3000/").concat(t,"/wav/").concat(i.path)),N(e)}else N(x)}),[i]),i&&i.path?(n=!0===h?a.createElement("a",{className:"play-sample-button",onClick:I},a.createElement("i",{className:"glyphicon glyphicon-pause"})):a.createElement("a",{className:"play-sample-button",onClick:function(){v(!0),document.getElementById("sample-".concat(s+1,"-").concat(r+1,"-audio-player")).play()}},a.createElement("i",{className:"glyphicon glyphicon-play-circle"})),t=a.createElement("a",{className:"edit-sample-button",onClick:function(){return m(r)}},a.createElement("i",{className:"glyphicon glyphicon-trash"}))):t=a.createElement("a",{className:"edit-sample-button",onClick:function(){return p(r)}},a.createElement("i",{className:"glyphicon glyphicon-plus"})),i&&((c=i.path?i.path:i.name)&&null!==c&&""!=c?(c.indexOf("/")>-1&&(c=c.split("/")[c.split("/").length-1]),c.split(".")[0].length>16&&(c=c.substring(0,17)+"...wav")):c="---");var b,z="---";return i&&i.path&&(z=c),i&&i.path&&(b=a.createElement("audio",{id:"sample-".concat(s+1,"-").concat(r+1,"-audio-player"),src:x,onTimeUpdate:function(e){return C(e)},onLoadedMetadata:function(e){return C(e)}})),a.createElement("li",{id:"sample-".concat(s+1,"-").concat(r+1)},b,n,a.createElement("h4",{title:i&&null!==c?i.path:""},z),t)};var f=t(9583),E=t(3356);const h=function(e){var n,t=e.index,o=e.samples,i=e.sampleSetMode,s=(e.keyzone_mode,(0,l.I0)()),u=(0,l.v9)((function(e){return e.sampleEditor})),m=u.sketchpad,d=u.sketchpadInfo,h=u.sourcePicker,v=u.dropZone;function k(e){"Escape"===e.key&&(s((0,c.RW)({showSourcePicker:!1})),s((0,c.i6)({showDropZone:!1})))}function y(){n=setTimeout((function(){s((0,c.i6)({showDropZone:!1}))}),10)}function g(e){s((0,c.RW)({channelIndex:t,sampleIndex:e,showSourcePicker:!0}))}function S(e,n){s((0,c.Qz)({files:[e],channelIndex:t,sampleIndex:n}))}function w(e){s((0,c.V_)({channelIndex:t,sampleIndex:e}))}(0,a.useEffect)((function(){return window.addEventListener("keydown",k,!1),function(){window.removeEventListener("keydown",k,!1)}}),[]);var x,N,I=o.map((function(e,n){return a.createElement(p,{key:n,index:n,sample:e?"sample-trig"==i?e:e[0]:null,channelIndex:t,sampleSetMode:i,onRemoveSample:w,onAddSample:g})}));if(h.channelIndex==t&&!0===h.showSourcePicker){var C=a.createElement("a",{className:"button",onClick:function(){s((0,c.RW)({showSourcePicker:!1})),s((0,c.i6)({channelIndex:t,isSampleSet:!0,showDropZone:!0}))}},"Load from External");h.sampleIndex&&(C=a.createElement("a",{className:"button"},a.createElement("input",{type:"file",onChange:function(e){return S(e.target.files[0],h.sampleIndex)}}),"Load from External")),x=a.createElement("div",{className:"sample-set-upload-container source-picker"},a.createElement("a",{className:"close-source-picker",onClick:function(){return s((0,c.RW)({showSourcePicker:!1}))}},a.createElement(f.zYX,null)),a.createElement("a",{className:"button",onClick:function(){return e=h.sampleIndex,s((0,r.v3)({folder:d.lastSelectedSketchpad.split("".concat(m.name,".sketchpad.json"))[0],mode:"LOAD",type:e||0===e?".wav":"sample-bank.json",sampleIndex:e,channelIndex:t})),void s((0,c.RW)({showSourcePicker:!1}));var e}},"Pick from Internal"),C)}v.channelIndex==t&&!0===v.isSampleSet&&!0===v.showDropZone&&(N=a.createElement("div",{className:"sample-set-upload-container"},a.createElement("div",{className:"dropzone-container"},a.createElement(E.ZP,{onDrop:function(e){return n=e,void s((0,c.Qz)({files:n,channelIndex:t}));var n}},(function(e){var n=e.getRootProps,t=e.getInputProps;return a.createElement("section",null,a.createElement("div",n(),a.createElement("input",t()),a.createElement("p",null,"Drag 'n' drop some files here")))})))));var b="hidden";!0===v.showDropZone&&v.channelIndex==t&&0==v.isSampleSet&&(b="");var z=m.tracks[t].samples.indexOf(null);return-1==z&&(z=m.tracks[t].samples.length-1),a.createElement(a.Fragment,null,a.createElement("div",{className:"sample-list-container "+("sample-loop"===i?"show-clips":""),onDragOver:function(){clearTimeout(n),s((0,c.i6)({showDropZone:!0,channelIndex:t,isSampleSet:!1}))},onDragLeave:y},a.createElement("div",{className:"dropzone-container "+b},a.createElement(E.ZP,{onDrop:function(e){return S(e[0],z)}},(function(e){var n=e.getRootProps,t=e.getInputProps;return a.createElement("section",null,a.createElement("div",n(),a.createElement("a",{onClick:function(){return y()},className:"close-source-picker"},a.createElement(f.zYX,null)),a.createElement("input",t()),a.createElement("p",null,"Drag 'n' drop some files here")))}))),a.createElement("ul",{className:"sample-list"},I)),x,N)},v=function(e){var n=e.index,t=e.keyzone_mode,r=e.trackType,o=(0,l.I0)();function i(e){o((0,c.pb)({index:n,keyzone_mode:t,trackType:e}))}function s(e){o((0,c.pb)({index:n,keyzone_mode:e,trackType:r}))}return a.createElement("div",{className:"track-keyzone-mode-menu"},a.createElement("div",{className:"track-audio-type-menu-container"},a.createElement("ul",null,a.createElement("li",null,a.createElement("a",{onClick:function(){return i("synth")},className:"synth"===r?"is-active":""},"Synth")),a.createElement("li",null,a.createElement("a",{onClick:function(){return i("sample-trig")},className:"sample-trig"===r?"is-active":""},"Sample")),a.createElement("li",null,a.createElement("a",{onClick:function(){return i("sample-loop")},className:"sample-loop"===r?"is-active":""},"Sketch")),a.createElement("li",null,a.createElement("a",{onClick:function(){return i("external")},className:"external"===r?"is-active":""},"External")))),a.createElement("div",{style:{opacity:"sample-trig"==r?"1":"0"},className:"keyzone-mode-menu-container"},a.createElement("span",null,"Key Split:"),a.createElement("ul",null,a.createElement("li",null,a.createElement("a",{onClick:function(){return s("all-full")},className:"all-full"===t?"is-active":""},"Off")),a.createElement("li",null,a.createElement("a",{onClick:function(){return s("split-narrow")},className:"split-narrow"===t?"is-active":""},"Narrow")))))};var k=t(7516);const y=function(e){var n=e.showEditMode,t=e.setShowEditMode,r=e.title,i=e.index,s=(0,l.I0)(),u=(0,a.useState)(r),d=(0,o.Z)(u,2),p=d[0],f=d[1],E=(0,a.useRef)(null),h=(0,a.useRef)(null);function v(e){"Escape"===e.key?E.current.click():"Enter"===e.key&&h.current.click()}(0,a.useEffect)((function(){return window.removeEventListener("keydown",v,!1),window.addEventListener("keydown",v,!1),function(){window.removeEventListener("keydown",v,!1)}}),[r]),(0,a.useEffect)((function(){!0===n&&f(r)}),[n]);var y=(0,a.useRef)();(0,m.t$)(y,(function(e){"edit-button"!==e.target.className&&t(!1)}));var g,S=null===r?"Track ".concat(i+1):r;return g=!0===n?a.createElement("div",{className:"input-wrapper"},a.createElement("input",{type:"text",placeholder:"",value:r,onChange:function(e){return s((0,c.f2)({index:i,title:e.target.value}))},autoFocus:!0}),a.createElement("a",{ref:E,className:"undo-title-change",onClick:function(){s((0,c.f2)({index:i,title:p})),t(!1)}},a.createElement(k.V3h,null)),a.createElement("a",{ref:h,className:"save-changes",onClick:function(){return f(r),void t(!1)}})):a.createElement("h2",null,S),a.createElement("div",{className:"sample-set-title"},a.createElement("div",{ref:y,className:"title-wrapper"},g))},g=function(e){var n,t=(0,l.I0)(),r=e.index,d=e.channel,p=e.color,f=(0,a.useState)(!1),E=(0,o.Z)(f,2),k=E[0],g=E[1],S=(0,a.useState)(!1),w=(0,o.Z)(S,2),x=w[0],N=w[1],I=(0,a.useRef)();return(0,m.t$)(I,(function(){return N(!1)})),!0===x&&(n=a.createElement("div",{className:"color-picker-container"},a.createElement(i.xS,{color:p,onChange:function(e){return t((0,c.Eh)({index:r,color:e.hex}))}}))),a.createElement(a.Fragment,null,a.createElement("div",{className:"sample-set",style:{backgroundColor:e.color}},a.createElement("div",{ref:I,className:"edit-menu-container"},a.createElement("ul",{className:"edit-menu"},a.createElement("li",null,a.createElement("a",{className:"edit-button",onClick:function(){return g(1!=k)}},a.createElement(u.rnx,null),a.createElement("span",{className:"edit-button"}))),a.createElement("li",null,a.createElement("a",{className:"color-picker",onClick:function(){return N(1!=x)}},a.createElement(s.R8K,null)))),n),a.createElement(y,{showEditMode:k,title:d.name,index:r,setShowEditMode:g}),a.createElement(v,{index:r,keyzone_mode:d.keyzone_mode,trackType:d.trackType}),a.createElement(h,{index:r,samples:"sample-trig"===d.trackType?d.samples:d.clips,sampleSetMode:d.trackType,keyzone_mode:d.keyzone_mode})))};var S=t(4578),w=t(3750);const x=function(e){var n=(0,l.I0)(),t=(0,l.v9)((function(e){return e.filePicker})),c=t.folder,i=t.initFolder,u=t.mode,d=t.files,p=t.selectedFile,E=t.type,h=t.channelIndex,v=t.sampleIndex,k=(0,a.useState)(""),y=(0,o.Z)(k,2),g=y[0],x=y[1];(0,a.useEffect)((function(){null!==c&&n((0,r.v0)())}),[c]);var N=(0,a.useRef)();function I(t){n((0,r.Fz)()),e.onSelectFile(t,h,v)}(0,m.t$)(N,(function(e){n((0,r.Fz)())}));var C,b="sample-set-load-from-sketch-pad-dialog";"SAVE"===u&&(b+=" w-save",C=a.createElement("div",{className:"dialog-footer"},a.createElement("input",{value:g,onChange:function(e){return x(e.target.value)},type:"text"}),a.createElement("button",{onClick:function(){I(c+g+E)}},"Save")));var z,P=a.createElement("li",null,a.createElement("a",null,"No files of type ".concat(E," were found")));return null!==d&&d.length>0&&(P=d.map((function(e,t){var l=a.createElement(s.On3,null),c="folder";return!1===e.isDir&&(l="wav"===(c=e.name.split(".")[e.name.split(".").length-1])?a.createElement(w.QEW,null):"json"===c?a.createElement(S.gkd,null):a.createElement(w.b0A,null)),a.createElement("li",{key:t},a.createElement("a",{onClick:function(){return n((0,r.KF)(e.name))},className:e.name===p?"active":"",onDoubleClick:function(){return function(e,t){"folder"===t||"cache"===t?n((0,r.I1)(e.path+"/")):I(e)}(e,c)}},l," ",e.name))}))),c!==i&&(z=a.createElement("li",null,a.createElement("a",{onDoubleClick:function(){return e=c.split("/")[c.split("/").length-2]+"/",t=c.split(e)[0],void n((0,r.I1)(t));var e,t}},a.createElement(s.y6u,null),"..."))),a.createElement("div",{ref:N,className:b},a.createElement("a",{className:"close",onClick:function(){return n((0,r.Fz)())}},a.createElement(f.zYX,null)),a.createElement("h4",null,u," FROM SKETCH PAD"),a.createElement("ul",null,z,P),C)},N=function(e){var n,t=e.colorsArray,o=(0,l.v9)((function(e){return e.sampleEditor})),i=o.sketchpadInfo,s=o.sketchpad,u=o.pendingFiles,m=(0,l.v9)((function(e){return e.filePicker})),d=m.showFilePicker,p=m.mode,f=m.type,E=(0,l.I0)();if((0,a.useEffect)((function(){E((0,c.l1)())}),[]),(0,a.useEffect)((function(){null!==i&&E((0,c.si)())}),[i]),(0,a.useEffect)((function(){if(null!==u.files){var e=u.files,n=u.channelIndex;E((0,c.qR)({files:e,channelIndex:n}))}}),[u]),null!==s){var h=i.lastSelectedSketchpad,v=h.split("/")[h.split("/").length-1],k=h.split(v)[0];k.indexOf("/zynthian/")>-1&&(k="/"+k.split("/zynthian/")[1]),n=s.tracks.map((function(e,n){return a.createElement(g,{key:n,index:n,color:e.color&&"#000000"!==e.color?e.color:t[n],channel:e})}))}var y,S={height:window.innerHeight-165};return window.innerHeight<865&&(S["overflow-y"]="scroll"),!0===d&&(y=a.createElement(x,{onSelectFile:function(e,n,t){if(".sketchpad.json"===f)if("SAVE"===p){var a=e,l=a.split("/")[a.split("/").length-1].split(".sketchpad.json")[0];E((0,c.R5)("/"+a.split("/zynthian/")[1])),E((0,c.UE)({filePath:a,fileName:l}))}else{var r=e;E((0,c.UE)({filePath:r.path,fileName:r.name}))}else".wav"===f?"LOAD"===p&&E((0,c.qR)({files:[e],channelIndex:n,sampleIndex:t})):"sample-bank.json"===f&&"LOAD"===p&&E((0,c.jO)({sampleSet:e,channelIndex:n}))}})),a.createElement(a.Fragment,null,a.createElement("div",{className:"sample-editor-menu"},a.createElement("ul",null,a.createElement("li",null,a.createElement("a",{onClick:function(){var e;(e=prompt("Enter Sketch name:"))&&E((0,c.Wp)(e))}},"New Sketchpad")),a.createElement("li",null,a.createElement("a",{onClick:function(){E((0,r.v3)({folder:"/zynthian/zynthian-my-data/sketchpads/my-sketchpads/",mode:"LOAD",type:".sketchpad.json"}))}},"Load")),a.createElement("li",null,a.createElement("a",{onClick:function(){return E((0,c.R5)())}},"Save")),a.createElement("li",null,a.createElement("a",{onClick:function(){var e;e=i.lastSelectedSketchpad.split("".concat(s.name,".sketchpad.json"))[0],E((0,r.v3)({folder:e,mode:"SAVE",type:".sketchpad.json"}))}},"Save As...")),null!==i?a.createElement("li",{style:{float:"right"}},a.createElement("a",null,i.lastSelectedSketchpad.substring(i.lastSelectedSketchpad.indexOf("my-sketchpads")))):"")),a.createElement("div",{id:"sample-editor",style:S},n),y)}}}]);