(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{17:function(e,t,n){"use strict";n.r(t);var a=n(36),c=n.n(a),r=n(51),l=n.n(r),o=n(27),i=n.n(o),s=n(1),u=n.n(s),p=n(28),m=n.n(p),f=n(0),d=n.n(f),h=n(72),E=n.n(h),y=n(373),k=n(63),v=n(364),w=n(133),S=n(34),b=n(136),g=n(132),j=function(e){var t,n,a,c=e.index,r=e.sample,l=e.trackIndex,o=e.removeSample,s=e.uploadSample,p=e.setLoadFromSketchPadSampleIndex,h=e.setLoadFromSketchPadFileType,E=e.setShowSampleSetSourcePicker,y=Object(f.useState)(null),k=u()(y,2),v=k[0],w=k[1],S=Object(f.useState)(!1),b=u()(S,2),g=b[0],j=b[1];function O(e){var t=new FileReader;t.addEventListener("load",(function(){var e=t.result;t.result.indexOf("data:application/octet-stream;")>-1&&(e=t.result.split(":application/octet-stream;").join(":audio/wav;")),w(e)}),!1),t.readAsDataURL(e)}function x(){return(x=i()(m.a.mark((function t(){var n,a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=r.path.split(".").join("++")).indexOf("/")>-1&&(n=n.split("/").join("+")),t.next=4,fetch("http://".concat(window.location.hostname,":3000/").concat("sample-loop"===e.sampleSetMode?"clip":"sample","/").concat(l+1+"+++"+n),{method:"GET",headers:{"Content-Type":"application/json"}});case 4:return a=t.sent,t.next=7,a.blob();case 7:O(t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(f.useEffect)((function(){r&&(r.name?(O(r),s(r,c)):r.path&&function(){x.apply(this,arguments)}())}),[r]),r&&null!==r&&null!==r.path?(t=!0===g?d.a.createElement("a",{className:"play-sample-button",onClick:function(){j(!1),document.getElementById("sample-".concat(l+1,"-").concat(c+1,"-audio-player")).pause()}},d.a.createElement("i",{className:"glyphicon glyphicon-pause"})):d.a.createElement("a",{className:"play-sample-button",onClick:function(){j(!0),document.getElementById("sample-".concat(l+1,"-").concat(c+1,"-audio-player")).play()}},d.a.createElement("i",{className:"glyphicon glyphicon-play-circle"})),n=d.a.createElement("a",{className:"edit-sample-button",onClick:function(){return o(r,c,!0)}},d.a.createElement("i",{className:"glyphicon glyphicon-trash"}))):n=d.a.createElement("a",{className:"edit-sample-button",onClick:function(){return function(e){h("wav"),p(e),E(!0)}(c)}},d.a.createElement("i",{className:"glyphicon glyphicon-plus"})),r&&(a=r.path?r.path:r.name)&&null!==a&&(a.indexOf("/")>-1&&(a=a.split("/")[a.split("/").length-1]),a.split(".")[0].length>16&&(a=a.substring(0,17)+"...wav"));var T="---";return a&&null!==a&&(T=a),d.a.createElement("li",{id:"sample-".concat(l+1,"-").concat(c+1)},d.a.createElement("audio",{id:"sample-".concat(l+1,"-").concat(c+1,"-audio-player"),src:v}),t,d.a.createElement("h4",{title:r&&null!==a?r.path:""},T),n)},O=n(362),x=n(131),T=function(e){var t="json"===e.fileType?"sketches/my-sketches/temp/wav/":"capture/";"SAVE"===e.actionType&&(t="/");var n,a=Object(f.useState)(null),c=u()(a,2),r=c[0],l=c[1],o=Object(f.useState)(t),s=u()(o,2),p=s[0],h=s[1],E=Object(f.useState)(""),y=u()(E,2),v=y[0],w=y[1],b=Object(f.useState)(null),j=u()(b,2),T=j[0],N=j[1];function C(){return P.apply(this,arguments)}function P(){return(P=i()(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://".concat(window.location.hostname,":3000/mydata/").concat(p.split("/").join("+++")),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,l(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}if(Object(f.useEffect)((function(){C()}),[]),Object(f.useEffect)((function(){null!==p&&(l(null),C())}),[p]),null!==r){var L="LOAD"===e.actionType?p:"zynthian-my-data/"+(p!==t?p+"/":"");n=r.map((function(t,n){var a=t.path,c=!0;a=t.path.split(L)[1];var r=d.a.createElement(k.a,null);if(a&&a.indexOf("/")>-1&&(c=!1,"LOAD"===e.actionType&&2===a.split("/").length&&(c=!0)),a&&a.indexOf(".")>-1){c=!1;var l=a.split(".")[a.split(".").length-1];r="json"===l?d.a.createElement(O.a,null):"wav"===l?d.a.createElement(x.b,null):d.a.createElement(x.a,null),("SAVE"===e.actionType&&1===a.split("/").length||"LOAD"===e.actionType&&l===e.fileType)&&(c=!0)}if(!0===c)return d.a.createElement("li",null,d.a.createElement("a",{onClick:function(){return N(a)},className:a===T?"active":"",onDoubleClick:function(){return function(t){if("LOAD"===e.actionType)"wav"===e.fileType?e.insertSample(t.path,e.sampleIndex):e.loadSampleSet(t),e.setShowLoadFromSketchPadDialog(!1);else if("SAVE"===e.actionType){var n=t.path.split("zynthian-my-data/")[1];h(n)}}(t)}},r," ",a))}))}var A,D=Object(f.useRef)();Object(S.b)(D,(function(t){e.setShowLoadFromSketchPadDialog(!1)})),p!==t&&(A=d.a.createElement("li",null,d.a.createElement("a",{onClick:function(){return function(){var e;if(p.indexOf("/")>-1){var n=p.split("/")[p.split("/").length-1];e=p.split("/"+n)[0]}else e=t;h(e)}()}},d.a.createElement(k.b,null)," ...")));var F,B="sample-set-load-from-sketch-pad-dialog";return"SAVE"===e.actionType&&(B+=" w-save",F=d.a.createElement("div",{className:"dialog-footer"},d.a.createElement("input",{value:v,onChange:function(e){return w(e.target.value)},type:"text"}),d.a.createElement("button",{onClick:function(){return t="/home/pi/zynthian-my-data"+("/"===p?"":"/")+p+("/"===p?"":"/")+v+"/",void e.saveSampleSet(t);var t}},"Save"))),d.a.createElement("div",{ref:D,className:B},d.a.createElement("a",{className:"close",onClick:function(){return e.setShowLoadFromSketchPadDialog(!1)}},d.a.createElement(g.a,null)),d.a.createElement("h4",null,e.actionType," ","wav"===e.fileType?"FILE":"SAMPLESET"," FROM SKETCH PAD"),d.a.createElement("ul",null,A,n),F)},N=function(e){var t=e.index,n=e.samples,a=e.setSamples,r=e.samplesArray,l=e.getTrackSampleSet,o=e.sampleSetMode,s=Object(f.useState)("hidden"),p=u()(s,2),h=p[0],y=p[1],v=Object(f.useState)(!1),w=u()(v,2),S=w[0],O=w[1],x=Object(f.useState)(!1),N=u()(x,2),C=N[0],P=N[1],L=Object(f.useState)("LOAD"),A=u()(L,2),D=A[0],F=A[1],B=Object(f.useState)(!1),M=u()(B,2),I=M[0],z=M[1],R=Object(f.useState)(null),J=u()(R,2),G=J[0],H=J[1],V=Object(f.useState)("wav"),Z=u()(V,2),_=Z[0],K=Z[1],Y="/zynthian-my-data/sketches/my-sketches/temp/wav/sampleset/bank.".concat(t+1,"/");function U(e){"Escape"===e.key&&(O(!1),P(!1),z(!1))}function q(e){O(!1);var t=G;null===G&&((t=n.findIndex((function(e){return null===e})))&&null!==t||(t=0));var r=[].concat(c()(n.slice(0,t)),[e],c()(n.slice(t+1,n.length)));a(r),H(null)}function Q(e,t,n){return W.apply(this,arguments)}function W(){return(W=i()(m.a.mark((function e(n,a,c){var r,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.name,e.next=3,fetch("http://".concat(window.location.hostname,":3000/track/").concat(t+1),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sIndex:a,sPath:r})});case 3:return l=e.sent,e.next=6,l.json();case 6:e.sent,$(n);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(f.useEffect)((function(){return window.addEventListener("keydown",U,!1),function(){window.removeEventListener("keydown",U,!1)}}),[]),Object(f.useEffect)((function(){!0===C&&O(!1)}),[C]),Object(f.useEffect)((function(){null!==G&&O(!0)}),[G]);var X,$=function(){var e=i()(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new FormData).append("file",t),E.a.post("http://".concat(window.location.hostname,":3000/upload/").concat(Y.split("/").join("+++")),n).then((function(e){}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function ee(e,t,n){return te.apply(this,arguments)}function te(){return(te=i()(m.a.mark((function n(c,r,l){var i,s,u,p;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("sample-loop"!==o){n.next=4;break}e.updateTrackClips("remove",t,r),n.next=13;break;case 4:return i=t+1,s=c.path,n.next=8,fetch("http://".concat(window.location.hostname,":3000/sample/").concat(i),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({trackIndex:i,sPath:s,sIndex:r})});case 8:return u=n.sent,n.next=11,u.json();case 11:p=n.sent,a(p);case 13:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function ne(e,t,n,a){return ae.apply(this,arguments)}function ae(){return(ae=i()(m.a.mark((function n(a,c,r,l){var i,s,u;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(H(null),"sample-loop"!==o){n.next=6;break}console.log("insert loop"),e.updateTrackClips("insert",t,c,a,r,l),n.next=15;break;case 6:return i=a.split("/")[a.split("/").length-1],s=i,n.next=10,fetch("http://".concat(window.location.hostname,":3000/track/").concat(t+1),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sIndex:c,sPath:s})});case 10:return u=n.sent,n.next=13,u.json();case 13:n.sent,ce(a,i,c,r,l);case 15:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function ce(e,t,n,a,c){return re.apply(this,arguments)}function re(){return(re=i()(m.a.mark((function e(t,a,c,r,o){var i,s,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=!0===o?"/home/pi"+Y+a:t,s=!0===o?t.split("/pi")[1]:Y+a,!1,e.next=5,fetch("http://".concat(window.location.hostname,":3000/copypaste"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({previousPath:i,destinationPath:s,deleteOrigin:!1})});case 5:return u=e.sent,e.next=8,u.json();case 8:e.sent,!0===r?c===n.length-1&&l():l();case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(){return(le=i()(m.a.mark((function e(a){var c,r,o,i,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.path.split("bank.")[1],r=a.path.split("/").join("+++"),e.next=4,fetch("http://".concat(window.location.hostname,":3000/json/").concat(r),{method:"GET",headers:{"Content-Type":"application/json"}});case 4:return o=e.sent,e.next=7,o.json();case 7:i=e.sent,s="/home/pi"+Y.split(t+1)[0]+c,i.forEach((function(e,t){null!==e?ne(s+e.path,t,!0):t===n.length-1&&l()}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var oe=r;"sample-loop"===e.sampleSetMode&&(oe=n);var ie,se,ue,pe=oe.map((function(a,c){return d.a.createElement(j,{key:c,index:c,sample:n[c],trackIndex:t,removeSample:ee,addSample:q,uploadSample:Q,setLoadFromSketchPadSampleIndex:H,setLoadFromSketchPadFileType:K,setShowSampleSetSourcePicker:O,sampleSetMode:e.sampleSetMode})}));if(!0===C&&(ie=d.a.createElement("div",{className:"sample-set-upload-container"},d.a.createElement("div",{className:"dropzone-container"},d.a.createElement(b.a,{onDrop:function(e){return function(e){var t=[];for(var n in e){var c={path:e[n].path,file:e[n]};t.push(c)}a(e),P(!1)}(e)}},(function(e){var t=e.getRootProps,n=e.getInputProps;return d.a.createElement("section",null,d.a.createElement("div",t(),d.a.createElement("input",n()),d.a.createElement("p",null,"Drag 'n' drop some files here")))}))))),!0===S){var me=d.a.createElement("a",{className:"button",onClick:function(){P(!0),O(!1)}},"Load from External");null!==G&&(me=d.a.createElement("a",{className:"button"},d.a.createElement("input",{type:"file",onChange:function(e){return q(e.target.files[0])}}),"Load from External")),se=d.a.createElement("div",{className:"sample-set-upload-container source-picker"},d.a.createElement("a",{onClick:function(){return O(!1)},className:"close-source-picker"},d.a.createElement(g.a,null)),d.a.createElement("a",{className:"button",onClick:function(){F("LOAD"),z(!0),O(!1)}},"Pick from Internal"),me)}if(!0===I){var fe=G;null===G&&((fe=n.findIndex((function(e){return null===e})))&&null!==fe||(fe=0)),ue=d.a.createElement(T,{actionType:D,setShowLoadFromSketchPadDialog:z,insertSample:ne,loadSampleSet:function(e){return le.apply(this,arguments)},saveSampleSet:function(e){var t=e.split("/pi")[1];fetch("http://".concat(window.location.hostname,":3000/createfolder"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullPath:t})}).then(function(){var t=i()(m.a.mark((function t(a){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.json();case 2:t.sent,n.forEach((function(t,n){null!==t&&ne(e+t.path,n,!0,!0)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},sampleIndex:fe,fileType:_})}return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"sample-list-container "+("sample-loop"===e.sampleSetMode?"show-clips":""),onDragOver:function(){clearTimeout(X),y("")},onDragLeave:function(){X=setTimeout((function(){y("hidden")}),10)}},d.a.createElement("div",{className:"dropzone-container "+h},d.a.createElement(b.a,{onDrop:function(e){return function(e){y("hidden"),e.forEach((function(e,t){q(e)}))}(e)}},(function(e){var t=e.getRootProps,n=e.getInputProps;return d.a.createElement("section",null,d.a.createElement("div",t(),d.a.createElement("input",n()),d.a.createElement("p",null,"Drag 'n' drop some files here")))}))),d.a.createElement("ul",{className:"sample-list"},pe)),d.a.createElement("ul",{className:"sample-set-actions"},d.a.createElement("li",null,d.a.createElement("a",{onClick:function(){n.forEach((function(e,t){var a=!1;t===n.length-1&&(a=!0),ee(e,t,a)}))}},d.a.createElement("i",{style:{marginTop:"1px"},className:"glyphicon glyphicon-trash"}))),d.a.createElement("li",null,d.a.createElement("a",{onClick:function(){return F("SAVE"),void z(!0)}}," ",d.a.createElement(k.c,null)," ")),d.a.createElement("li",{style:{float:"right"}},d.a.createElement("a",{onClick:function(){K("json"),P(!1),O(!0!==S)}},d.a.createElement("i",{className:"glyphicon glyphicon-plus"})))),ie,se,ue)},C=function(e){var t=e.showEditMode,n=e.setShowEditMode,a=e.title,c=e.updateTrack,r=e.index,l=Object(f.useState)(a),o=u()(l,2),i=o[0],s=o[1],p=Object(f.useRef)(null),m=Object(f.useRef)(null);function h(e){"Escape"===e.key?p.current.click():"Enter"===e.key&&m.current.click()}Object(f.useEffect)((function(){return window.removeEventListener("keydown",h,!1),window.addEventListener("keydown",h,!1),function(){window.removeEventListener("keydown",h,!1)}}),[a]),Object(f.useEffect)((function(){!0===t&&s(a)}),[t]);var E=Object(f.useRef)();Object(S.b)(E,(function(e){"edit-button"!==e.target.className&&n(!1)}));var y,k=null===a?"Track ".concat(r+1):a;return y=!0===t?d.a.createElement("div",{className:"input-wrapper"},d.a.createElement("input",{type:"text",placeholder:"",value:a,onChange:function(e){return c(r,e.target.value)},autoFocus:!0}),d.a.createElement("a",{ref:p,className:"undo-title-change",onClick:function(){c(r,i),n(!1)}},d.a.createElement(w.b,null)),d.a.createElement("a",{ref:m,className:"save-changes",onClick:function(){return s(a),void n(!1)}})):d.a.createElement("h2",null,k),d.a.createElement("div",{className:"sample-set-title"},d.a.createElement("div",{ref:E,className:"title-wrapper"},y))},P=function(e){var t=e.index,n=e.title,a=e.color,c=e.keyZoneMode,r=e.trackAudioType,l=e.updateTrack;function o(e){l(t,n,a,e)}function i(e){l(t,n,a,c,e)}return d.a.createElement("div",{className:"track-keyzone-mode-menu"},d.a.createElement("div",{className:"track-audio-type-menu-container"},d.a.createElement("ul",null,d.a.createElement("li",null,d.a.createElement("a",{onClick:function(){return i("sample-trig")},className:"sample-trig"===r?"is-active":""},"Trig")),d.a.createElement("li",null,d.a.createElement("a",{onClick:function(){return i("sample-slice")},className:"sample-slice"===r?"is-active":""},"Slice")))),d.a.createElement("div",{style:{opacity:"sample-trig"==r?"1":"0"},className:"keyzone-mode-menu-container"},d.a.createElement("span",null,"Auto Split:"),d.a.createElement("ul",null,d.a.createElement("li",null,d.a.createElement("a",{onClick:function(){return o("all-full")},className:"all-full"===c?"is-active":""},"Off")),d.a.createElement("li",null,d.a.createElement("a",{onClick:function(){return o("split-full")},className:"split-full"===c?"is-active":""},"Auto")),d.a.createElement("li",null,d.a.createElement("a",{onClick:function(){return o("split-narrow")},className:"split-narrow"===c?"is-active":""},"Narrow")))))},L=function(e){var t=[null,null,null,null,null],n=e.index,a=e.track,c=e.color,r=e.updateTrackClips,l=Object(f.useState)(t),o=u()(l,2),s=o[0],p=o[1],h=Object(f.useState)(!1),E=u()(h,2),w=E[0],b=E[1],g=Object(f.useState)(!1),j=u()(g,2),O=j[0],x=j[1],T=Object(f.useRef)();function L(){return A.apply(this,arguments)}function A(){return(A=i()(m.a.mark((function e(){var t,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://".concat(window.location.hostname,":3000/track/").concat(n+1),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:(a=e.sent)&&p(a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(S.b)(T,(function(){return x(!1)})),Object(f.useEffect)((function(){L()}),[]),Object(f.useEffect)((function(){e.track&&null!==e.track&&L()}),[e.track]);var D;return!0===O&&(D=d.a.createElement("div",{className:"color-picker-container"},d.a.createElement(y.a,{color:c,onChange:function(t){e.updateTrack(n,a.name,t.hex)}}))),d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"sample-set",style:{backgroundColor:e.color}},d.a.createElement("div",{ref:T,className:"edit-menu-container"},d.a.createElement("ul",{className:"edit-menu"},d.a.createElement("li",null,d.a.createElement("a",{className:"edit-button",onClick:function(){return b(1!=w)}},d.a.createElement(v.a,null),d.a.createElement("span",{className:"edit-button"}))),d.a.createElement("li",null,d.a.createElement("a",{className:"color-picker",onClick:function(){return x(1!=O)}},d.a.createElement(k.d,null)))),D),d.a.createElement(C,{showEditMode:w,title:a.name,index:n,setShowEditMode:b,updateTrack:e.updateTrack}),d.a.createElement(P,{index:n,title:a.name,color:c,keyZoneMode:a.keyzone_mode,trackAudioType:a.trackAudioType,updateTrack:e.updateTrack}),d.a.createElement(N,{index:n,samples:"sample-loop"===a.trackAudioType?a.clips:s,setSamples:p,samplesArray:t,getTrackSampleSet:L,sampleSetMode:a.trackAudioType,keyZoneMode:a.keyzone_mode,updateTrackClips:r})))},A=function(e){var t=e.setShowFilePicker,n=e.onSelect,a=Object(f.useState)(null),c=u()(a,2),r=c[0],l=c[1];function o(){return(o=i()(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://".concat(window.location.hostname,":3000/sketchlist/"),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,l(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(f.useEffect)((function(){!function(){o.apply(this,arguments)}()}),[]);var s="";if(null!==r){var p=r.map((function(e,t){if(e.indexOf(".sketch.json")>-1)return d.a.createElement("li",{key:t},d.a.createElement("a",{onClick:function(){return n(e,!0)}},e))}));s=d.a.createElement("ul",null,p)}return d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{id:"sample-editor-file-picker"},d.a.createElement("h4",null,"Load Sketch File"),s),d.a.createElement("div",{onClick:function(){return t(!1)},id:"sample-editor-file-picker-overlay"}))},D=n(2);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=Object(f.lazy)((function(){return n.e(15).then(n.bind(null,418))}));t.default=function(e){var t,n,a,r=e.colorsArray,l=Object(f.useState)(null),o=u()(l,2),s=o[0],p=o[1],h=Object(f.useState)(null),y=u()(h,2),k=y[0],v=y[1],w=Object(f.useState)(null),S=u()(w,2),b=S[0],g=S[1],j=Object(f.useState)(!1),O=u()(j,2),x=O[0],T=O[1],N=Object(f.useState)(!1),C=u()(N,2),P=C[0],F=C[1],I=Object(f.useState)(null),z=u()(I,2),R=z[0],J=z[1];function G(){return(G=i()(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://".concat(window.location.hostname,":3000/sketchinfo/"),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,p(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return(H=i()(m.a.mark((function e(){var t,n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.lastSelectedSketch,e.next=3,fetch("http://".concat(window.location.hostname,":3000/sketch/").concat(t.split("/").join("+++")),{method:"GET",headers:{"Content-Type":"application/json"}});case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,v(a);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){return Z.apply(this,arguments)}function Z(){return(Z=i()(m.a.mark((function e(t){var n,a,c,r,l,o,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=k,t&&"string"==typeof t&&(n.name=t),a=JSON.stringify(k),c=s.lastSelectedSketch.split("zynthian/")[1],r=s.lastSelectedSketch.split("/")[s.lastSelectedSketch.split("/").length-1],l=new Blob([a],{type:"application/json"}),o=new FormData,i=c.split(r)[0],t&&"string"==typeof t&&(r=t),o.append("file",l,r),E.a.post("http://".concat(window.location.hostname,":3000/upload/").concat(i.split("/").join("+++")),o).then((function(e){t&&"string"==typeof t&&(_(t),v(n))}));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return K.apply(this,arguments)}function K(){return(K=i()(m.a.mark((function e(t){var n,a,c,r,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:T(!1),n=s.lastSelectedSketch.split("/")[s.lastSelectedSketch.split("/").length-1],a=s.lastSelectedSketch.split(n)[0],c=B(B({},s),{},{lastSelectedSketch:a+t}),r=new Blob([JSON.stringify(c)],{type:"application/json"}),(l=new FormData).append("file",r,".cache.json"),E.a.post("http://".concat(window.location.hostname,":3000/upload/zynthian-my-data+++sessions+++"),l).then((function(e){p(c)}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e,t,n,a,c){var r=k.tracks[e],l=B(B({},r),{},{name:t,color:n,keyzone_mode:a&&null!==a?a:r.keyzone_mode,trackAudioType:c&&null!==c?c:r.trackAudioType}),o=[];k.tracks.forEach((function(t,n){n===e?o.push(l):o.push(t)}));var i=B(B({},k),{},{tracks:o});v(i)}function U(e,t,n,a,c,r){return q.apply(this,arguments)}function q(){return(q=i()(m.a.mark((function e(t,n,a,r,l,o){var i,s,u,p,f,d;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=k.tracks[n],"remove"!==t){e.next=14;break}return console.log("remove clip from track"),u=k.tracks[n].clips[a].path,e.next=6,fetch("http://".concat(window.location.hostname,":3000/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullPath:u})});case 6:return p=e.sent,e.next=9,p.json();case 9:f=e.sent,console.log(f,"data res on remove"),s=B(B({},i),{},{clips:[].concat(c()(i.clips.slice(0,n)),[B(B({},i.clips[a]),{},{path:null})],c()(i.clips.slice(n+1,i.clips.length-1)))}),e.next=15;break;case 14:"insert"===t?console.log("insert clip into track"):"upload"===t&&console.log("upload clip to track");case 15:d=B(B({},k),{},{tracks:[].concat(c()(k.tracks.slice(0,n)),[s],c()(k.tracks.slice(n+1,k.tracks.length-1)))}),v(d),V();case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e){J(e),F(!0)}if(Object(f.useEffect)((function(){!function(){G.apply(this,arguments)}(),setTimeout((function(){var e=document.getElementById("sample-editor").clientHeight;console.log(e,window.innerHeight)}),100)}),[]),Object(f.useEffect)((function(){null!==s&&function(){H.apply(this,arguments)}()}),[s]),Object(f.useEffect)((function(){null!==k&&g(k.tracks)}),[k]),null!==b){t=b.map((function(e,t){if(t<10)return d.a.createElement(L,{key:t,index:t,color:e.color&&"#000000"!==e.color?e.color:r[t],updateTrack:Y,onShowPatternEditor:Q,track:e,updateTrackClips:U})}))}!0===x&&(n=d.a.createElement(A,{onSelect:_,setShowFilePicker:T})),!0===P&&(a=d.a.createElement(f.Suspense,{fallback:d.a.createElement(D.a,null)},d.a.createElement(M,{trackIndex:R})));var W={height:window.innerHeight-165};return window.innerHeight<865&&(W["overflow-y"]="scroll"),d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{className:"sample-editor-menu"},d.a.createElement("ul",null,d.a.createElement("li",null,d.a.createElement("a",null,"New")),d.a.createElement("li",null,d.a.createElement("a",{onClick:function(){return T(!0!==x)}},"Load")),d.a.createElement("li",null,d.a.createElement("a",{onClick:V},"Save")),d.a.createElement("li",null,d.a.createElement("a",{onClick:function(){V(window.prompt("Enter FileName")+".sketch.json")}},"Save As...")),null!==s?d.a.createElement("li",{style:{float:"right"}},d.a.createElement("a",null,s.lastSelectedSketch)):"")),d.a.createElement("div",{id:"sample-editor",style:W},t),n,a)}},34:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return l}));var a=n(0);function c(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=t?1e3:1024;if(Math.abs(e)<a)return e+" B";var c=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r=-1,l=Math.pow(10,n);do{e/=a,++r}while(Math.round(Math.abs(e)*l)/l>=a&&r<c.length-1);return e.toFixed(n)+" "+c[r]}function r(e,t){Object(a.useEffect)((function(){var n=function(n){e.current&&!e.current.contains(n.target)&&t(n)};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),function(){document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,t])}function l(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current=e}),[e]),t.current}}}]);